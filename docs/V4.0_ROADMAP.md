# Prometheus v4.0 å¼€å‘è·¯çº¿å›¾

## ğŸ“… å¼€å‘æ—¶é—´çº¿
- å¼€å§‹æ—¥æœŸï¼š2025å¹´12æœˆ1æ—¥
- ç›®æ ‡å‘å¸ƒï¼šå¾…å®š

## ğŸ¯ v4.0 ä¸»è¦ç›®æ ‡

### 1. æ¶æ„ä¼˜åŒ–
- [ ] å®Œå–„æ¨¡å—åŒ–æ¶æ„
- [ ] ä¼˜åŒ–æ ¸å¿ƒäº¤æ˜“å¼•æ“æ€§èƒ½
- [ ] æ”¹è¿›é”™è¯¯å¤„ç†å’Œæ—¥å¿—ç³»ç»Ÿ
- [ ] å¢å¼ºç³»ç»Ÿç¨³å®šæ€§å’Œå¯é æ€§

### 2. åŠŸèƒ½å¢å¼º
- [ ] æ–°çš„ç­–ç•¥ç®—æ³•
- [ ] æ”¹è¿›çš„é£é™©ç®¡ç†ç³»ç»Ÿ
- [ ] æ›´æ™ºèƒ½çš„èµ„é‡‘åˆ†é…æœºåˆ¶
- [ ] å¢å¼ºçš„å¸‚åœºåˆ†æèƒ½åŠ›

### 3. è¿›åŒ–ç³»ç»Ÿå‡çº§
- [ ] ä¼˜åŒ–é—ä¼ ç®—æ³•
- [ ] æ”¹è¿›Agentè¿›åŒ–æœºåˆ¶
- [ ] å¢å¼ºç¯å¢ƒå‹åŠ›ç³»ç»Ÿ
- [ ] æ›´å¥½çš„å¤šæ ·æ€§ä¿æŒ

### 4. ç”¨æˆ·ä½“éªŒ
- [ ] æ”¹è¿›ç›‘æ§ç•Œé¢
- [ ] æ›´ç›´è§‚çš„é…ç½®ç³»ç»Ÿ
- [ ] å®Œå–„çš„æ–‡æ¡£å’Œç¤ºä¾‹
- [ ] ç®€åŒ–éƒ¨ç½²æµç¨‹

### 5. æ€§èƒ½ä¼˜åŒ–
- [ ] æå‡å›æµ‹é€Ÿåº¦
- [ ] ä¼˜åŒ–å†…å­˜ä½¿ç”¨
- [ ] å‡å°‘APIè°ƒç”¨å»¶è¿Ÿ
- [ ] æ”¹è¿›å¹¶å‘å¤„ç†

## ğŸ”„ å½“å‰çŠ¶æ€
- **åˆ†æ”¯**: `develop/v4.0`
- **åŸºäº**: v3.1.0 (mainåˆ†æ”¯)
- **çŠ¶æ€**: å¼€å‘åˆæœŸ

## ğŸ“ å¼€å‘è§„èŒƒ

### åˆ†æ”¯å‘½åè§„èŒƒ
- åŠŸèƒ½å¼€å‘: `feature/v4.0-åŠŸèƒ½åç§°`
- Bugä¿®å¤: `bugfix/v4.0-é—®é¢˜æè¿°`
- æ€§èƒ½ä¼˜åŒ–: `perf/v4.0-ä¼˜åŒ–é¡¹`
- æ–‡æ¡£æ›´æ–°: `docs/v4.0-æ–‡æ¡£è¯´æ˜`

### æäº¤ä¿¡æ¯è§„èŒƒ
```
ç±»å‹(èŒƒå›´): ç®€çŸ­æè¿°

è¯¦ç»†æè¿°ï¼ˆå¯é€‰ï¼‰

Breaking Changesï¼ˆå¦‚æœ‰ï¼‰
```

ç±»å‹ï¼š
- feat: æ–°åŠŸèƒ½
- fix: Bugä¿®å¤
- perf: æ€§èƒ½ä¼˜åŒ–
- refactor: ä»£ç é‡æ„
- docs: æ–‡æ¡£æ›´æ–°
- test: æµ‹è¯•ç›¸å…³
- chore: æ„å»º/å·¥å…·é“¾ç›¸å…³

### ä»£ç å®¡æŸ¥è¦æ±‚
- æ‰€æœ‰åŠŸèƒ½å¿…é¡»æœ‰å•å…ƒæµ‹è¯•
- ä»£ç è¦†ç›–ç‡ä¸ä½äº80%
- å¿…é¡»é€šè¿‡æ‰€æœ‰CIæ£€æŸ¥
- è‡³å°‘ä¸€äººå®¡æŸ¥é€šè¿‡

## ğŸš€ é‡Œç¨‹ç¢‘

### Milestone 1: æ¶æ„ä¼˜åŒ– (é¢„è®¡2å‘¨)
- å®Œå–„prometheusåŒ…ç»“æ„
- ä¼˜åŒ–æ ¸å¿ƒæ¨¡å—æ¥å£
- æ”¹è¿›é”™è¯¯å¤„ç†

### Milestone 2: åŠŸèƒ½å¢å¼º (é¢„è®¡4å‘¨)
- å®ç°æ–°ç­–ç•¥ç®—æ³•
- å‡çº§é£é™©ç®¡ç†
- ä¼˜åŒ–èµ„é‡‘åˆ†é…

### Milestone 3: ç³»ç»Ÿæµ‹è¯• (é¢„è®¡2å‘¨)
- å®Œæ•´çš„é›†æˆæµ‹è¯•
- æ€§èƒ½åŸºå‡†æµ‹è¯•
- å‹åŠ›æµ‹è¯•

### Milestone 4: æ–‡æ¡£å’Œå‘å¸ƒ (é¢„è®¡1å‘¨)
- å®Œå–„æ‰€æœ‰æ–‡æ¡£
- å‡†å¤‡å‘å¸ƒè¯´æ˜
- åˆ›å»ºè¿ç§»æŒ‡å—

## ğŸ“š å‚è€ƒæ–‡æ¡£
- [v3.1 åŠŸèƒ½æ¸…å•](RELEASE_NOTES_v3.1.md)
- [æ¶æ„è®¾è®¡](DESIGN.md)
- [è¿ç§»æŒ‡å—](MIGRATION_GUIDE.md)
- [æŠ€æœ¯æŒ‡æ ‡è¯´æ˜](TECHNICAL_INDICATORS.md)

## ğŸ’¡ æƒ³æ³•å’Œå»ºè®®
ï¼ˆåœ¨è¿™é‡Œè®°å½•å¼€å‘è¿‡ç¨‹ä¸­çš„æƒ³æ³•å’Œæ”¹è¿›å»ºè®®ï¼‰

---

## ğŸ”® v4.1 å¼€å‘è®¡åˆ’ï¼ˆä¸‹ä¸€ç‰ˆæœ¬ï¼‰

### æ ¸å¿ƒåŠŸèƒ½ï¼šåµŒå…¥å¼æ•°æ®åº“

**è§¦å‘æ¡ä»¶**ï¼ˆæ»¡è¶³ä»»ä¸€å³å¯åŠ¨å¼€å‘ï¼‰ï¼š
- [ ] Agentæ•°é‡ > 50
- [ ] éœ€è¦7å¤©ä»¥ä¸Šå†å²æ•°æ®åˆ†æ
- [ ] å®ç°Elysiumæ­»äº¡å­˜æ¡£ç³»ç»Ÿ
- [ ] å®ç°åŸºå› è¿›åŒ–/ç¹æ®–åŠŸèƒ½
- [ ] ç³»ç»Ÿéœ€è¦24/7ç¨³å®šè¿è¡Œ

**æŠ€æœ¯é€‰å‹**ï¼šSQLiteï¼ˆPythonå†…ç½®æ”¯æŒï¼Œç¨³å®šå¯é ï¼‰

**æ•°æ®åº“Schemaè®¾è®¡**ï¼š

```sql
-- Agentè¡¨ï¼ˆå«åŸºå› æ•°æ®ï¼‰
CREATE TABLE agents (
    id TEXT PRIMARY KEY,
    gene_data JSON,
    personality JSON,
    birth_time DATETIME,
    death_time DATETIME,
    parent_ids TEXT,  -- çˆ¶ä»£Agentï¼ˆè¿›åŒ–ç”¨ï¼‰
    generation INTEGER,  -- ç¬¬å‡ ä»£
    status TEXT  -- 'alive', 'dead', 'archived'
);

-- äº¤æ˜“è®°å½•è¡¨
CREATE TABLE trades (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    agent_id TEXT,
    trade_type TEXT,  -- 'buy', 'sell', 'short', 'cover', 'add', 'reduce'
    symbol TEXT,
    amount REAL,
    price REAL,
    pnl REAL,
    fees REAL,
    confidence REAL,
    timestamp DATETIME,
    cycle_number INTEGER,
    FOREIGN KEY (agent_id) REFERENCES agents(id)
);

-- æ’åå¿«ç…§è¡¨ï¼ˆå†å²è¿½æº¯ï¼‰
CREATE TABLE ranking_snapshots (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    timestamp DATETIME,
    cycle_number INTEGER,
    rankings JSON,
    population_stats JSON,
    evolution_signals JSON
);

-- é¢„è¨€å†å²è¡¨
CREATE TABLE prophecies (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    level TEXT,  -- 'grand', 'minor'
    trend_forecast TEXT,
    bullish_score REAL,
    risk_level TEXT,
    content JSON,
    timestamp DATETIME
);

-- Elysiumè¡¨ï¼ˆæ­»äº¡Agentå­˜æ¡£ï¼‰
CREATE TABLE elysium (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    agent_id TEXT,
    gene_data JSON,
    final_pnl REAL,
    total_trades INTEGER,
    win_rate REAL,
    lifespan_cycles INTEGER,
    death_reason TEXT,  -- 'eliminated', 'bankruptcy', 'manual'
    archived_at DATETIME
);

-- ç³»ç»ŸçŠ¶æ€å¿«ç…§ï¼ˆå´©æºƒæ¢å¤ç”¨ï¼‰
CREATE TABLE system_snapshots (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    timestamp DATETIME,
    cycle_number INTEGER,
    agents_state JSON,
    public_ledger JSON,
    bulletin_board JSON
);
```

### v4.1 å…¶ä»–åŠŸèƒ½è®¡åˆ’

| åŠŸèƒ½ | ä¼˜å…ˆçº§ | ä¾èµ– | è¯´æ˜ |
|------|--------|------|------|
| **SQLiteæŒä¹…åŒ–** | P0 | - | æ ¸å¿ƒæ•°æ®åº“åŠŸèƒ½ |
| **å´©æºƒè‡ªåŠ¨æ¢å¤** | P0 | SQLite | åŸºäºå¿«ç…§æ¢å¤ç³»ç»ŸçŠ¶æ€ |
| **Elysiumç³»ç»Ÿ** | P1 | SQLite | æ­»äº¡Agentçµé­‚å­˜æ¡£ |
| **åŸºå› è¿›åŒ–/ç¹æ®–** | P1 | SQLite + Elysium | ä¼˜ç§€Agentç¹æ®–ï¼Œå·®åŠ²Agentæ·˜æ±° |
| **å†å²ç»©æ•ˆåˆ†æ** | P2 | SQLite | é•¿æœŸç­–ç•¥æœ‰æ•ˆæ€§åˆ†æ |
| **å¤šç­–ç•¥å›æµ‹** | P2 | SQLite | åŸºäºå†å²æ•°æ®å›æµ‹æ–°ç­–ç•¥ |
| **Webç›‘æ§é¢æ¿** | P3 | SQLite | å®æ—¶ç›‘æ§Agentè¡¨ç° |

### æ•°æ®åº“æ¥å£é¢„ç•™

ä¸ºä¾¿äºæœªæ¥åˆ‡æ¢ï¼Œå½“å‰ä»£ç åº”é¢„ç•™ä»¥ä¸‹æ¥å£ï¼š

```python
# æŠ½è±¡å­˜å‚¨æ¥å£ï¼ˆæœªæ¥å®ç°ï¼‰
class StorageBackend(ABC):
    @abstractmethod
    def save_trade(self, trade: TradeRecord): pass
    
    @abstractmethod
    def save_agent(self, agent: Agent): pass
    
    @abstractmethod
    def save_snapshot(self, snapshot: dict): pass
    
    @abstractmethod
    def load_latest_snapshot(self) -> dict: pass

# å½“å‰å†…å­˜å®ç°
class MemoryStorage(StorageBackend): ...

# v4.1 SQLiteå®ç°
class SQLiteStorage(StorageBackend): ...
```

---
æœ€åæ›´æ–°ï¼š2025å¹´12æœˆ3æ—¥

