# Prometheus v3.0 - å‚æ•°è¯¦è§£ä¸è°ƒä¼˜æŒ‡å—

![Parameters](https://img.shields.io/badge/Parameters-Complete-green)
![Configuration](https://img.shields.io/badge/Configuration-Advanced-blue)
![Docker Support](https://img.shields.io/badge/Docker-Supported-green)

**ç‰ˆæœ¬**: 1.1  
**æ—¥æœŸ**: 2025å¹´11æœˆ29æ—¥

## ğŸ“‘ ç›®å½•

- [1. å‚æ•°è®¾è®¡å“²å­¦ï¼šåœ¨æ··æ²Œä¸­å¯»æ‰¾ç§©åº](#1-å‚æ•°è®¾è®¡å“²å­¦åœ¨æ··æ²Œä¸­å¯»æ‰¾ç§©åº)
- [2. é…ç½®æ–‡ä»¶ç»“æ„](#2-é…ç½®æ–‡ä»¶ç»“æ„)
- [3. ç³»ç»Ÿçº§å‚æ•° (`config_virtual.py`)](#3-ç³»ç»Ÿçº§å‚æ•°-config_virtualpy)
- [4. å¸‚åœºé…ç½®å‚æ•° (`markets`)](#4-å¸‚åœºé…ç½®å‚æ•°-markets)
- [5. é£æ§å‚æ•° (`risk`)](#5-é£æ§å‚æ•°-risk)
- [6. AgentåŸºå› å‚æ•° (`live_agent.py`)](#6-agentåŸºå› å‚æ•°-live_agentpy)
- [7. å¸‚åœºçŠ¶æ€æ£€æµ‹å‚æ•° (`market_regime.py`)](#7-å¸‚åœºçŠ¶æ€æ£€æµ‹å‚æ•°-market_regimepy)
- [8. Dockerç¯å¢ƒå‚æ•°](#8-dockerç¯å¢ƒå‚æ•°)
- [9. ç›‘æ§ä¸æ—¥å¿—å‚æ•°](#9-ç›‘æ§ä¸æ—¥å¿—å‚æ•°)
- [10. è°ƒä¼˜æŒ‡å—](#10-è°ƒä¼˜æŒ‡å—)
- [11. é…ç½®ç¤ºä¾‹](#11-é…ç½®ç¤ºä¾‹)
- [12. æœ€ä½³å®è·µ](#12-æœ€ä½³å®è·µ)
- [13. å¸¸è§é—®é¢˜è§£ç­”](#13-å¸¸è§é—®é¢˜è§£ç­”)

---

## 1. å‚æ•°è®¾è®¡å“²å­¦ï¼šåœ¨æ··æ²Œä¸­å¯»æ‰¾ç§©åº

Prometheusç³»ç»Ÿçš„å‚æ•°è®¾è®¡éµå¾ªä»¥ä¸‹åŸåˆ™ï¼š

- **åˆ†å±‚è®¾è®¡**: å‚æ•°æŒ‰åŠŸèƒ½å’Œå½±å“èŒƒå›´è¿›è¡Œæ¸…æ™°åˆ†å±‚
- **å¯æ‰©å±•æ€§**: æ”¯æŒé…ç½®æ–‡ä»¶ã€ç¯å¢ƒå˜é‡å’ŒDockerå‚æ•°å¤šæºé…ç½®
- **å®‰å…¨æ€§ä¼˜å…ˆ**: é£æ§å‚æ•°é»˜è®¤è®¾ç½®ä¸ºä¿å®ˆå€¼ï¼Œç¡®ä¿èµ„é‡‘å®‰å…¨
- **è‡ªé€‚åº”**: æ ¸å¿ƒäº¤æ˜“å‚æ•°é€šè¿‡é—ä¼ ç®—æ³•åŠ¨æ€ä¼˜åŒ–

### 1.1 å‚æ•°åˆ†ç±»ä½“ç³»

Prometheusç³»ç»Ÿçš„å‚æ•°åˆ†ä¸ºå…­å¤§ç±»ï¼š

1.  **ç³»ç»Ÿçº§å‚æ•°**ï¼šå†³å®šç³»ç»Ÿçš„å®è§‚è¿è¡Œæ–¹å¼å’Œèµ„æºåˆ†é…
2.  **å¸‚åœºé…ç½®å‚æ•°**ï¼šå®šä¹‰äº¤æ˜“å¸‚åœºå’Œèµ„é‡‘åˆ†é…ç­–ç•¥
3.  **é£æ§å‚æ•°**ï¼šç³»ç»Ÿçš„"å®‰å…¨å¸¦"ï¼Œå†³å®šé£é™©æ‰¿å—èƒ½åŠ›
4.  **AgentåŸºå› å‚æ•°**ï¼šå†³å®šæ¯ä¸ªAgentçš„å¾®è§‚äº¤æ˜“è¡Œä¸ºï¼Œæ˜¯è¿›åŒ–çš„æ ¸å¿ƒ
5.  **ç¯å¢ƒé…ç½®å‚æ•°**ï¼šDockerå’Œéƒ¨ç½²ç¯å¢ƒç›¸å…³è®¾ç½®
6.  **ç›‘æ§ä¸æ—¥å¿—å‚æ•°**ï¼šç³»ç»Ÿç›‘æ§å’Œæ—¥å¿—è®°å½•ç›¸å…³é…ç½®

> "å‚æ•°è°ƒä¼˜çš„è‰ºæœ¯ï¼Œä¸åœ¨äºæ‰¾åˆ°ä¸€ä¸ªå®Œç¾çš„ç»„åˆï¼Œè€Œåœ¨äºç†è§£æ¯ä¸ªå‚æ•°èƒŒåçš„è¡Œä¸ºé€»è¾‘ï¼Œå¹¶è®©å®ƒä»¬ååŒå·¥ä½œã€‚"

### 1.2 å‚æ•°ä¼˜å…ˆçº§

å½“å‚æ•°åœ¨å¤šä¸ªä½ç½®å®šä¹‰æ—¶ï¼Œåº”ç”¨ä»¥ä¸‹ä¼˜å…ˆçº§è§„åˆ™ï¼š

1. **Dockerç¯å¢ƒå˜é‡**ï¼ˆæœ€é«˜ä¼˜å…ˆçº§ï¼‰
2. **è‡ªå®šä¹‰é…ç½®æ–‡ä»¶** (`custom_config.py`)
3. **é»˜è®¤é…ç½®æ–‡ä»¶** (`config_virtual.py`)
4. **ç¡¬ç¼–ç é»˜è®¤å€¼**ï¼ˆæœ€ä½ä¼˜å…ˆçº§ï¼‰

è¿™ç§è®¾è®¡ç¡®ä¿äº†åœ¨ä¸åŒéƒ¨ç½²ç¯å¢ƒä¸‹çš„çµæ´»æ€§å’Œä¸€è‡´æ€§ã€‚

## 2. é…ç½®æ–‡ä»¶ç»“æ„

### 2.1 æ ‡å‡†é…ç½®æ–‡ä»¶

```
config/
â”œâ”€â”€ config_virtual.py    # é»˜è®¤é…ç½®ï¼ŒåŒ…å«æ‰€æœ‰å‚æ•°çš„è¯¦ç»†è¯´æ˜
â””â”€â”€ custom_config.py     # è‡ªå®šä¹‰é…ç½®ï¼Œç”¨äºè¦†ç›–é»˜è®¤å€¼
```

### 2.2 Dockerç¯å¢ƒä¸‹çš„é…ç½®

```
docker/
â”œâ”€â”€ docker-compose.yml   # Docker Composeé…ç½®
â”œâ”€â”€ .env.example         # ç¯å¢ƒå˜é‡ç¤ºä¾‹æ–‡ä»¶
â””â”€â”€ .env                 # å®é™…ç¯å¢ƒå˜é‡æ–‡ä»¶ï¼ˆä¸æäº¤åˆ°ç‰ˆæœ¬æ§åˆ¶ï¼‰
```

### 2.3 é…ç½®åŠ è½½æµç¨‹

```mermaid
flowchart TD
    A[ç³»ç»Ÿå¯åŠ¨] --> B{æ£€æŸ¥ç¯å¢ƒå˜é‡}
    B -->|å­˜åœ¨| C[åŠ è½½ç¯å¢ƒå˜é‡]
    B -->|ä¸å­˜åœ¨| D{æ£€æŸ¥custom_config.py}
    C --> E[è¦†ç›–é»˜è®¤é…ç½®]
    D -->|å­˜åœ¨| F[åŠ è½½è‡ªå®šä¹‰é…ç½®]
    D -->|ä¸å­˜åœ¨| G[ä½¿ç”¨é»˜è®¤é…ç½®]
    F --> E
    G --> H[åˆå§‹åŒ–ç³»ç»Ÿç»„ä»¶]
    E --> H
```

---

## 3. ç³»ç»Ÿçº§å‚æ•° (`config_virtual.py`)

è¿™äº›å‚æ•°å®šä¹‰äº†ç³»ç»Ÿçš„åŸºæœ¬æ¡†æ¶å’Œè¿è¡ŒèŠ‚å¥ï¼Œå¯¹ç³»ç»Ÿæ•´ä½“æ€§èƒ½å’Œèµ„æºå ç”¨æœ‰é‡è¦å½±å“ã€‚

| å‚æ•° | é»˜è®¤å€¼ | ç±»å‹ | ç¯å¢ƒå˜é‡å | å«ä¹‰ | è°ƒä¼˜å»ºè®® |
|---|---|---|---|---|---|
| `initial_capital` | 5000 | float | `INITIAL_CAPITAL` | åˆå§‹æ€»èµ„é‡‘ | æ ¹æ®æ‚¨çš„å®é™…æƒ…å†µè®¾ç½®ã€‚å»ºè®®ä»æ¨¡æ‹Ÿç›˜å¼€å§‹ã€‚ |
| `initial_agents` | 5 | int | `INITIAL_AGENTS` | åˆå§‹Agentæ•°é‡ | **å»ºè®®5-10ä¸ª**ã€‚å¤ªå°‘åˆ™å¤šæ ·æ€§ä¸è¶³ï¼Œå¤ªå¤šåˆ™è®¡ç®—èµ„æºæ¶ˆè€—å¤§ã€‚ |
| `max_agents` | 10 | int | `MAX_AGENTS` | æœ€å¤§Agentæ•°é‡ | **å»ºè®®ä¸ºåˆå§‹æ•°é‡çš„2-3å€**ã€‚ç”¨äºæ§åˆ¶ç§ç¾¤è§„æ¨¡ï¼Œé˜²æ­¢æ— é™ç¹æ®–ã€‚ |
| `update_interval` | 60 | int | `UPDATE_INTERVAL` | ç³»ç»Ÿæ›´æ–°é—´éš”ï¼ˆç§’ï¼‰ | **60ç§’æ˜¯å‡è¡¡é€‰æ‹©**ã€‚çŸ­äº30ç§’å¯èƒ½è§¦å‘APIé¢‘ç‡é™åˆ¶ï¼Œé•¿äº300ç§’å¯èƒ½é”™è¿‡æœºä¼šã€‚ |
| `order_timeout` | 300 | int | `ORDER_TIMEOUT` | è®¢å•è¶…æ—¶æ—¶é—´ï¼ˆç§’ï¼‰ | **å»ºè®®300-600ç§’**ã€‚å¦‚æœè®¢å•åœ¨æ­¤æ—¶é™å†…æœªæˆäº¤ï¼Œå°†è¢«å–æ¶ˆã€‚ |
| `retry_attempts` | 3 | int | `RETRY_ATTEMPTS` | APIè°ƒç”¨é‡è¯•æ¬¡æ•° | **å»ºè®®3-5æ¬¡**ã€‚ç”¨äºåº”å¯¹ç½‘ç»œæ³¢åŠ¨æˆ–APIä¸´æ—¶é”™è¯¯ã€‚ |
| `api_rate_limit` | 60 | int | `API_RATE_LIMIT` | æ¯åˆ†é’Ÿæœ€å¤§APIè°ƒç”¨æ¬¡æ•° | æ ¹æ®äº¤æ˜“æ‰€é™åˆ¶è°ƒæ•´ã€‚OKXé»˜è®¤é™åˆ¶ä¸º60æ¬¡/åˆ†é’Ÿã€‚ |
| `gene_mutation_rate` | 0.1 | float | `GENE_MUTATION_RATE` | åŸºå› å˜å¼‚ç‡ | å»ºè®®0.05-0.15ä¹‹é—´ã€‚å€¼è¶Šé«˜å¤šæ ·æ€§è¶Šå¼ºï¼Œä½†ç¨³å®šæ€§å¯èƒ½é™ä½ã€‚ |
| `evolve_interval` | 86400 | int | `EVOLVE_INTERVAL` | è¿›åŒ–å‘¨æœŸï¼ˆç§’ï¼‰ | é»˜è®¤24å°æ—¶ã€‚å†³å®šAgentç§ç¾¤å¤šä¹…è¿›åŒ–ä¸€æ¬¡ã€‚ |
| `keep_best_agents` | 0.2 | float | `KEEP_BEST_AGENTS` | ä¿ç•™æœ€ä¼˜Agentæ¯”ä¾‹ | é»˜è®¤ä¿ç•™20%æœ€ä¼˜Agentã€‚ç”¨äºä¿è¯è¿›åŒ–è¿‡ç¨‹ä¸­çš„ä¼˜è´¨åŸºå› ä¸ä¼šä¸¢å¤±ã€‚ |

### 3.1 èµ„æºç›¸å…³å‚æ•°

| å‚æ•° | é»˜è®¤å€¼ | ç±»å‹ | ç¯å¢ƒå˜é‡å | å«ä¹‰ | è°ƒä¼˜å»ºè®® |
|---|---|---|---|---|---|
| `max_memory_usage` | 2048 | int | `MAX_MEMORY_USAGE` | æœ€å¤§å†…å­˜ä½¿ç”¨é‡ï¼ˆMBï¼‰ | æ ¹æ®æœåŠ¡å™¨é…ç½®è°ƒæ•´ã€‚Dockerç¯å¢ƒä¸‹è‡ªåŠ¨å—å®¹å™¨é™åˆ¶ã€‚ |
| `max_cpu_usage` | 1.0 | float | `MAX_CPU_USAGE` | æœ€å¤§CPUä½¿ç”¨ç‡ï¼ˆæ ¸å¿ƒæ•°ï¼‰ | æ ¹æ®æœåŠ¡å™¨é…ç½®è°ƒæ•´ã€‚Dockerç¯å¢ƒä¸‹è‡ªåŠ¨å—å®¹å™¨é™åˆ¶ã€‚ |
| `worker_threads` | 4 | int | `WORKER_THREADS` | å·¥ä½œçº¿ç¨‹æ•°é‡ | å»ºè®®ä¸ºCPUæ ¸å¿ƒæ•°çš„0.5-1å€ã€‚å½±å“å¹¶å‘å¤„ç†èƒ½åŠ›ã€‚ |

### 3.2 å¼€å‘ä¸è°ƒè¯•å‚æ•°

| å‚æ•° | é»˜è®¤å€¼ | ç±»å‹ | ç¯å¢ƒå˜é‡å | å«ä¹‰ | è°ƒä¼˜å»ºè®® |
|---|---|---|---|---|---|
| `debug_mode` | False | bool | `DEBUG_MODE` | è°ƒè¯•æ¨¡å¼å¼€å…³ | ç”Ÿäº§ç¯å¢ƒå¿…é¡»å…³é—­ã€‚å¼€å¯åä¼šè¾“å‡ºè¯¦ç»†æ—¥å¿—ã€‚ |
| `dry_run` | True | bool | `DRY_RUN` | æ¨¡æ‹Ÿäº¤æ˜“æ¨¡å¼ | åˆå§‹ä½¿ç”¨æ—¶å»ºè®®å¼€å¯ï¼Œç†Ÿæ‚‰ç³»ç»Ÿåå†å…³é—­ã€‚ |
| `log_level` | "INFO" | str | `LOG_LEVEL` | æ—¥å¿—çº§åˆ« | å¯é€‰ï¼šDEBUG, INFO, WARNING, ERROR, CRITICAL |

## 4. å¸‚åœºé…ç½®å‚æ•° (`markets`)

å¸‚åœºé…ç½®å®šä¹‰äº†äº¤æ˜“çš„å…·ä½“å¸‚åœºã€äº¤æ˜“å¯¹å’Œèµ„é‡‘åˆ†é…ç­–ç•¥ã€‚

### 4.1 é»˜è®¤å¸‚åœºé…ç½®

```python
'markets': {
    'spot': {
        'enabled': True,
        'symbol': 'BTC-USDT',
        'allocation': 0.5,  # 50%èµ„é‡‘åˆ†é…ç»™ç°è´§
        'max_order_size': 0.2,  # å•ç¬”æœ€å¤§è®¢å•æ¯”ä¾‹
        'min_order_size': 0.001  # å•ç¬”æœ€å°è®¢å•æ¯”ä¾‹
    },
    'futures': {
        'enabled': True,
        'symbol': 'BTC-USDT-SWAP',
        'allocation': 0.5,  # 50%èµ„é‡‘åˆ†é…ç»™åˆçº¦
        'max_leverage': 3,   # æœ€å¤§æ æ†å€æ•°
        'min_leverage': 1,   # æœ€å°æ æ†å€æ•°
        'auto_deleverage': False  # æ˜¯å¦å…è®¸è‡ªåŠ¨å‡ä»“
    }
}
```

### 4.2 å¸‚åœºå‚æ•°è¯¦è§£

| å‚æ•° | é»˜è®¤å€¼ | ç±»å‹ | ç¯å¢ƒå˜é‡å | é€‚ç”¨å¸‚åœº | å«ä¹‰ | è°ƒä¼˜å»ºè®® |
|---|---|---|---|---|---|---|
| `enabled` | True | bool | - | spot/futures | æ˜¯å¦å¯ç”¨è¯¥å¸‚åœº | å¯ä»¥åªå¯ç”¨ä¸€ä¸ªå¸‚åœºè¿›è¡Œæµ‹è¯• |
| `symbol` | "BTC-USDT" | str | - | spot | ç°è´§äº¤æ˜“å¯¹ | OKXæ”¯æŒçš„ç°è´§äº¤æ˜“å¯¹ |
| `symbol` | "BTC-USDT-SWAP" | str | - | futures | åˆçº¦äº¤æ˜“å¯¹ | OKXæ”¯æŒçš„åˆçº¦äº¤æ˜“å¯¹ |
| `allocation` | 0.5 | float | - | spot/futures | èµ„é‡‘åˆ†é…æ¯”ä¾‹ | **å»ºè®®ç°è´§å’Œåˆçº¦å„å 50%**ï¼Œä»¥åˆ†æ•£é£é™© |
| `max_leverage` | 3 | int | `MAX_LEVERAGE` | futures | æœ€å¤§æ æ†å€æ•° | **å¼ºçƒˆå»ºè®®æ–°æ‰‹ä¸è¦è¶…è¿‡3å€**ã€‚é«˜æ æ†æ˜¯çˆ†ä»“çš„ä¸»è¦åŸå›  |
| `min_leverage` | 1 | int | - | futures | æœ€å°æ æ†å€æ•° | é€šå¸¸ä¸º1ï¼Œä¸å»ºè®®ä¿®æ”¹ |
| `max_order_size` | 0.2 | float | - | spot/futures | å•ç¬”æœ€å¤§è®¢å•æ¯”ä¾‹ | å•ç¬”è®¢å•ä½¿ç”¨è¯¥å¸‚åœºèµ„é‡‘çš„æœ€å¤§æ¯”ä¾‹ |
| `min_order_size` | 0.001 | float | - | spot/futures | å•ç¬”æœ€å°è®¢å•æ¯”ä¾‹ | é˜²æ­¢ä¸‹å•è¿‡å°çš„æ— æ•ˆè®¢å• |
| `auto_deleverage` | False | bool | - | futures | æ˜¯å¦å…è®¸è‡ªåŠ¨å‡ä»“ | å»ºè®®å…³é—­ï¼Œä»¥é¿å…æç«¯æƒ…å†µä¸‹çš„å¼ºåˆ¶å¹³ä»“ |

### 4.3 å¤šäº¤æ˜“å¯¹é…ç½®ç¤ºä¾‹

é«˜çº§ç”¨æˆ·å¯ä»¥é…ç½®å¤šä¸ªäº¤æ˜“å¯¹è¿›è¡Œåˆ†æ•£åŒ–äº¤æ˜“ï¼š

```python
'markets': {
    'spot': {
        'enabled': True,
        'symbols': [  # å¤šäº¤æ˜“å¯¹é…ç½®
            {'pair': 'BTC-USDT', 'allocation': 0.3},
            {'pair': 'ETH-USDT', 'allocation': 0.2}
        ]
    },
    'futures': {
        'enabled': True,
        'symbols': [
            {'pair': 'BTC-USDT-SWAP', 'allocation': 0.3, 'max_leverage': 3},
            {'pair': 'ETH-USDT-SWAP', 'allocation': 0.2, 'max_leverage': 2}
        ]
    }
}
```

> **æ³¨æ„**ï¼šå¤šäº¤æ˜“å¯¹é…ç½®éœ€è¦æ›´å¤šçš„è®¡ç®—èµ„æºå’ŒAPIè°ƒç”¨æ¬¡æ•°ï¼Œå»ºè®®åœ¨ç³»ç»Ÿç¨³å®šè¿è¡Œåå†å°è¯•ã€‚

---

## 5. é£æ§å‚æ•° (`risk`)

é£æ§å‚æ•°æ˜¯ç³»ç»Ÿçš„ç”Ÿå‘½çº¿ï¼Œå†³å®šäº†ç³»ç»Ÿèƒ½æ‰¿å—å¤šå¤§çš„é£é™©ã€‚è¯·åŠ¡å¿…è°¨æ…è°ƒæ•´è¿™äº›å‚æ•°ï¼Œå°¤å…¶æ˜¯åœ¨å®ç›˜ç¯å¢ƒä¸­ã€‚

### 5.1 æ ¸å¿ƒé£æ§å‚æ•°

| å‚æ•° | é»˜è®¤å€¼ | ç±»å‹ | ç¯å¢ƒå˜é‡å | å«ä¹‰ | è°ƒä¼˜å»ºè®® |
|---|---|---|---|---|---|
| `max_daily_trades` | 100 | int | `MAX_DAILY_TRADES` | æ¯æ—¥æœ€å¤§äº¤æ˜“æ¬¡æ•° | **å»ºè®®100-200æ¬¡**ã€‚é˜²æ­¢ç³»ç»Ÿåœ¨å¼‚å¸¸è¡Œæƒ…ä¸‹å¤±æ§åˆ·å•ã€‚ |
| `max_daily_loss` | 0.10 | float | `MAX_DAILY_LOSS` | æ¯æ—¥æœ€å¤§äºæŸæ¯”ä¾‹ | **æ ¸å¿ƒé£æ§å‚æ•°**ã€‚å½“æ€»èµ„é‡‘äºæŸè¾¾åˆ°10%æ—¶ï¼Œç³»ç»Ÿå°†æš‚åœæ‰€æœ‰äº¤æ˜“ã€‚**å»ºè®®0.05-0.15**ã€‚ |
| `max_drawdown` | 0.20 | float | `MAX_DRAWDOWN` | æœ€å¤§å›æ’¤æ¯”ä¾‹ | å½“ä»æœ€é«˜ç‚¹å›æ’¤è¾¾åˆ°20%æ—¶ï¼Œç³»ç»Ÿå°†æš‚åœäº¤æ˜“ã€‚**å»ºè®®0.15-0.30**ã€‚ |
| `max_leverage` | 3 | int | `GLOBAL_MAX_LEVERAGE` | å…¨å±€æœ€å¤§æ æ† | å³ä½¿åˆçº¦å¸‚åœºè®¾ç½®äº†æ›´é«˜æ æ†ï¼Œä¹Ÿä¼šè¢«æ­¤å‚æ•°é™åˆ¶ã€‚**æ˜¯æœ€åçš„ä¿é™©ä¸**ã€‚ |
| `max_position_pct` | 0.30 | float | `MAX_POSITION_PCT` | å•ç¬”è®¢å•æœ€å¤§ä»“ä½ | å•ç¬”è®¢å•ä½¿ç”¨çš„èµ„é‡‘ä¸èƒ½è¶…è¿‡æ€»èµ„é‡‘çš„30%ã€‚**å»ºè®®0.2-0.5**ã€‚ |
| `stop_loss_pct` | 0.05 | float | `DEFAULT_STOP_LOSS_PCT` | é»˜è®¤æ­¢æŸæ¯”ä¾‹ | å¦‚æœAgentåŸºå› ä¸­çš„æ­¢æŸå‚æ•°å¼‚å¸¸ï¼Œå°†ä½¿ç”¨æ­¤é»˜è®¤å€¼ã€‚ |
| `max_order_value` | 500 | float | `MAX_ORDER_VALUE` | å•ç¬”è®¢å•æœ€å¤§é‡‘é¢ | é˜²æ­¢ä¸‹å‡ºå¤©ä»·å•ã€‚**å»ºè®®è®¾ç½®ä¸º`initial_capital`çš„10%å·¦å³**ã€‚ |

### 5.2 é£æ§è§¦å‘åçš„è¡Œä¸ºå‚æ•°

| å‚æ•° | é»˜è®¤å€¼ | ç±»å‹ | ç¯å¢ƒå˜é‡å | å«ä¹‰ | è°ƒä¼˜å»ºè®® |
|---|---|---|---|---|---|
| `cool_down_period` | 3600 | int | `COOL_DOWN_PERIOD` | é£æ§è§¦å‘åçš„å†·å´æœŸï¼ˆç§’ï¼‰ | é»˜è®¤1å°æ—¶ã€‚é£æ§è§¦å‘åï¼Œç³»ç»Ÿå°†åœ¨æ­¤æ—¶é—´æ®µå†…æš‚åœäº¤æ˜“ã€‚ |
| `notify_on_risk_trigger` | True | bool | `NOTIFY_ON_RISK_TRIGGER` | æ˜¯å¦åœ¨é£æ§è§¦å‘æ—¶å‘é€é€šçŸ¥ | å»ºè®®å¼€å¯ï¼Œä»¥ä¾¿åŠæ—¶äº†è§£ç³»ç»ŸçŠ¶æ€ã€‚ |
| `close_positions_on_risk` | True | bool | `CLOSE_POSITIONS_ON_RISK` | é£æ§è§¦å‘æ—¶æ˜¯å¦è‡ªåŠ¨å¹³ä»“ | å®ç›˜ç¯å¢ƒå»ºè®®å¼€å¯ï¼Œæ¨¡æ‹Ÿç›˜å¯ä»¥å…³é—­ä»¥ä¾¿åˆ†æã€‚ |

### 5.3 é«˜çº§é£æ§è®¾ç½®

```python
'risk': {
    # åŸºç¡€é£æ§å‚æ•°...
    
    # é«˜çº§é£æ§è®¾ç½®
    'advanced': {
        'market_volatility_threshold': 0.05,  # å¸‚åœºæ³¢åŠ¨ç‡é˜ˆå€¼
        'volatility_check_window': 3600,      # æ³¢åŠ¨ç‡æ£€æŸ¥çª—å£ï¼ˆç§’ï¼‰
        'circuit_breaker': {
            'enabled': True,
            'price_drop_threshold': 0.15,     # ä»·æ ¼ä¸‹è·Œè§¦å‘ç†”æ–­é˜ˆå€¼
            'volume_spike_threshold': 3.0,    # æˆäº¤é‡æš´å¢è§¦å‘ç†”æ–­é˜ˆå€¼
            'cooldown_minutes': 30            # ç†”æ–­å†·å´æ—¶é—´ï¼ˆåˆ†é’Ÿï¼‰
        },
        'anti_martingale': {
            'enabled': True,
            'base_position_size': 0.05,       # åŸºç¡€ä»“ä½å¤§å°
            'max_position_size': 0.25,        # æœ€å¤§ä»“ä½å¤§å°
            'loss_multiplier': 1.5            # äºæŸåçš„ä»“ä½è°ƒæ•´å€æ•°
        }
    }
}
```

> **é‡è¦æç¤º**ï¼šé£æ§å‚æ•°çš„è°ƒæ•´åº”åŸºäºå……åˆ†çš„å›æµ‹å’Œæ¨¡æ‹Ÿç›˜æµ‹è¯•ã€‚åœ¨å®ç›˜ç¯å¢ƒä¸­ï¼Œå»ºè®®ä»ä¿å®ˆçš„è®¾ç½®å¼€å§‹ï¼Œéšç€å¯¹ç³»ç»Ÿç†è§£çš„æ·±å…¥å†é€æ­¥è°ƒæ•´ã€‚ |

---

## 6. AgentåŸºå› å‚æ•° (`live_agent.py`)

AgentåŸºå› å‚æ•°æ˜¯é—ä¼ ç®—æ³•çš„æ ¸å¿ƒï¼Œå†³å®šäº†Agentçš„å¤šæ ·æ€§å’Œè¿›åŒ–æ–¹å‘ã€‚æ¯ä¸ªAgentåœ¨è¯ç”Ÿæ—¶ä¼šéšæœºç”Ÿæˆä¸€å¥—åŸºå› ï¼Œå¹¶åœ¨è¿›åŒ–è¿‡ç¨‹ä¸­ä¸æ–­ä¼˜åŒ–ã€‚

### 6.1 åŸºç¡€åŸºå› å‚æ•°

| å‚æ•° | é»˜è®¤èŒƒå›´ | ç±»å‹ | ç¯å¢ƒå˜é‡å | å«ä¹‰ | è°ƒä¼˜å»ºè®® |
|---|---|---|---|---|---|
| `long_threshold` | 0.05-0.15 | float | - | åšå¤šä¿¡å·é˜ˆå€¼ | **æ ¸å¿ƒç­–ç•¥å‚æ•°**ã€‚å½“åŠ¨é‡æŒ‡æ ‡è¶…è¿‡æ­¤å€¼æ—¶è§¦å‘åšå¤šã€‚å€¼è¶Šå°è¶Šæ¿€è¿›ã€‚ |
| `short_threshold` | -0.15--0.05 | float | - | åšç©ºä¿¡å·é˜ˆå€¼ | å½“åŠ¨é‡æŒ‡æ ‡ä½äºæ­¤å€¼æ—¶è§¦å‘åšç©ºã€‚å€¼è¶Šå¤§è¶Šæ¿€è¿›ã€‚ |
| `max_position` | 0.5-1.0 | float | - | æœ€å¤§ä»“ä½æ¯”ä¾‹ | Agentè‡ªèº«èµ„é‡‘çš„æœ€å¤§ä½¿ç”¨æ¯”ä¾‹ã€‚**å»ºè®®0.8-1.0**ï¼Œè®©Agentå……åˆ†åˆ©ç”¨èµ„é‡‘ã€‚ |
| `stop_loss` | 0.03-0.08 | float | - | æ­¢æŸç™¾åˆ†æ¯” | **å†³å®šAgentçš„ç”Ÿå­˜èƒ½åŠ›**ã€‚å¤ªå°å®¹æ˜“è¢«éœ‡è¡æ­¢æŸï¼Œå¤ªå¤§åˆ™äºæŸä¸¥é‡ã€‚ |
| `take_profit` | 0.05-0.15 | float | - | æ­¢ç›ˆç™¾åˆ†æ¯” | **å†³å®šAgentçš„ç›ˆåˆ©èƒ½åŠ›**ã€‚å¤ªå°èµšå¾—å°‘ï¼Œå¤ªå¤§åˆ™å®¹æ˜“å›ååˆ©æ¶¦ã€‚ |
| `holding_period` | 300-3600 | int | - | æŒä»“å‘¨æœŸï¼ˆç§’ï¼‰ | Agentæ„¿æ„æŒä»“çš„æœ€é•¿æ—¶é—´ã€‚**å»ºè®®300-7200ç§’ï¼ˆ5åˆ†é’Ÿ-2å°æ—¶ï¼‰**ã€‚ |
| `risk_aversion` | 0.5-1.5 | float | - | é£é™©åŒæ¶ç³»æ•° | **å½±å“Agentçš„å†³ç­–åå¥½**ã€‚å€¼è¶Šé«˜ï¼ŒAgentè¶Šå€¾å‘äºè§„é¿é£é™©ã€‚ |
| `entry_confirmation` | 1-3 | int | - | å…¥åœºç¡®è®¤æ¬¡æ•° | éœ€è¦è¿ç»­å¤šå°‘æ¬¡ä¿¡å·ç¡®è®¤æ‰å…¥åœºã€‚é˜²æ­¢å‡çªç ´ã€‚ |
| `exit_confirmation` | 1-2 | int | - | å‡ºåœºç¡®è®¤æ¬¡æ•° | éœ€è¦è¿ç»­å¤šå°‘æ¬¡ä¿¡å·ç¡®è®¤æ‰å‡ºåœºã€‚é¿å…è¿‡æ—©ç¦»åœºã€‚ |
| `market_regime_weight` | 0.3-0.7 | float | - | å¸‚åœºçŠ¶æ€æƒé‡ | å¸‚åœºçŠ¶æ€å¯¹äº¤æ˜“å†³ç­–çš„å½±å“æƒé‡ã€‚ |

### 6.2 é«˜çº§åŸºå› å‚æ•°

| å‚æ•° | é»˜è®¤èŒƒå›´ | ç±»å‹ | å«ä¹‰ | è°ƒä¼˜å»ºè®® |
|---|---|---|---|---|
| `trailing_stop_enabled` | True/False | bool | æ˜¯å¦å¯ç”¨è¿½è¸ªæ­¢æŸ | å»ºè®®å¯ç”¨ï¼Œå¯æé«˜åˆ©æ¶¦ä¿æŠ¤èƒ½åŠ›ã€‚ |
| `trailing_stop_distance` | 0.02-0.05 | float | è¿½è¸ªæ­¢æŸè·ç¦» | æ­¢æŸä»·æ ¼ä¸å½“å‰ä»·æ ¼çš„æœ€å°è·ç¦»ã€‚ |
| `position_scaling` | 0.1-0.3 | float | ä»“ä½ç¼©æ”¾å› å­ | åˆ†æ‰¹å»ºä»“æ—¶æ¯æ‰¹çš„æ¯”ä¾‹ã€‚ |
| `profit_taking_strategy` | 0-2 | int | åˆ©æ¶¦è·å–ç­–ç•¥ | 0:ä¸€æ¬¡æ€§, 1:åˆ†æ‰¹, 2:åŠ¨æ€è°ƒæ•´ |
| `drawdown_recovery` | 0.5-1.5 | float | å›æ’¤æ¢å¤ç³»æ•° | å›æ’¤åè°ƒæ•´é£é™©åå¥½çš„ç³»æ•°ã€‚ |

### 6.3 åŸºå› å˜å¼‚æœºåˆ¶

å½“ä¸€ä¸ªä¼˜ç§€çš„Agent"ç¹æ®–"åä»£æ—¶ï¼Œåä»£çš„åŸºå› ä¼šåœ¨çˆ¶ä»£çš„åŸºç¡€ä¸Šå‘ç”Ÿ**è½»å¾®å˜å¼‚**ã€‚å˜å¼‚æœºåˆ¶å¦‚ä¸‹ï¼š

```python
# åŸºå› å˜å¼‚ç¤ºä¾‹
def mutate_gene(parent_gene_value, mutation_rate=0.1, gene_range=None):
    # æ ¹æ®å˜å¼‚ç‡å†³å®šæ˜¯å¦å˜å¼‚
    if random.random() < mutation_rate:
        # é«˜æ–¯å˜å¼‚ï¼Œå‡å€¼ä¸ºçˆ¶ä»£åŸºå› å€¼ï¼Œæ ‡å‡†å·®ä¸ºçˆ¶ä»£åŸºå› å€¼çš„10%
        new_value = parent_gene_value * (1 + random.gauss(0, 0.1))
        
        # å¦‚æœæœ‰èŒƒå›´é™åˆ¶ï¼Œç¡®ä¿æ–°å€¼åœ¨èŒƒå›´å†…
        if gene_range:
            new_value = max(gene_range[0], min(gene_range[1], new_value))
            
        return new_value
    return parent_gene_value
```

### 6.4 åŸºå› ç¼–ç ä¸è§£ç 

åŸºå› å‚æ•°åœ¨ç³»ç»Ÿå†…éƒ¨ä»¥æ ‡å‡†åŒ–çš„æ–¹å¼è¿›è¡Œç¼–ç å’Œè§£ç ï¼š

```python
def encode_gene(gene_value, gene_min, gene_max):
    # å°†åŸºå› å€¼æ ‡å‡†åŒ–åˆ°[0,1]åŒºé—´
    return (gene_value - gene_min) / (gene_max - gene_min)

def decode_gene(encoded_value, gene_min, gene_max):
    # å°†[0,1]åŒºé—´çš„å€¼è§£ç å›åŸå§‹èŒƒå›´
    return encoded_value * (gene_max - gene_min) + gene_min
```

è¿™ç§ç¼–ç æ–¹å¼ä½¿å¾—ä¸åŒå‚æ•°èŒƒå›´çš„åŸºå› å¯ä»¥åœ¨ç»Ÿä¸€çš„ç©ºé—´å†…è¿›è¡Œæ“ä½œï¼Œæœ‰åˆ©äºé—ä¼ ç®—æ³•çš„é«˜æ•ˆè¿è¡Œã€‚

---

## 7. å¸‚åœºçŠ¶æ€æ£€æµ‹å‚æ•° (`market_regime.py`)

å¸‚åœºçŠ¶æ€æ£€æµ‹å‚æ•°å†³å®šäº†ç³»ç»Ÿå¦‚ä½•è¯†åˆ«å’Œå“åº”ä¸åŒçš„å¸‚åœºç¯å¢ƒï¼Œæ˜¯ç³»ç»Ÿé€‚åº”ä¸åŒå¸‚åœºæ¡ä»¶çš„å…³é”®ã€‚

### 7.1 åŸºç¡€å¸‚åœºçŠ¶æ€å®šä¹‰

| çŠ¶æ€ | 30æ—¥æ¶¨è·Œå¹…å®šä¹‰ | æŠ€æœ¯æŒ‡æ ‡ç‰¹å¾ | äº¤æ˜“ç­–ç•¥å»ºè®® |
|---|---|---|---|
| **Strong Bull** | æ¶¨å¹… > 20% | æ³¢åŠ¨ç‡ä½ï¼Œè¶‹åŠ¿å¼ºï¼ŒRSIä¸­é«˜ | é€‚åˆè¿½æ¶¨ï¼Œå¢åŠ åšå¤šAgentæƒé‡ |
| **Weak Bull** | æ¶¨å¹… 5-20% | æ³¢åŠ¨ç‡ä¸­ç­‰ï¼Œè¶‹åŠ¿å‘ä¸Š | é€‚åˆé€¢ä½åšå¤šï¼Œå¹³è¡¡é…ç½® |
| **Sideways** | æ¶¨è·Œå¹… Â±5% | æ³¢åŠ¨ç‡ä½ï¼Œè¶‹åŠ¿ä¸æ˜æ˜¾ | é€‚åˆé«˜æŠ›ä½å¸æˆ–è§‚æœ›ï¼Œé™ä½ä»“ä½ |
| **Weak Bear** | è·Œå¹… 5-20% | æ³¢åŠ¨ç‡ä¸­ç­‰ï¼Œè¶‹åŠ¿å‘ä¸‹ | é€‚åˆé€¢é«˜åšç©ºï¼Œåå‘åšç©ºé…ç½® |
| **Strong Bear** | è·Œå¹… > 20% | æ³¢åŠ¨ç‡é«˜ï¼Œè¶‹åŠ¿å¼ºï¼ŒRSIä½ | é€‚åˆè¿½ç©ºï¼Œå¢åŠ åšç©ºAgentæƒé‡ |

### 7.2 é«˜çº§å¸‚åœºçŠ¶æ€æ£€æµ‹å‚æ•°

```python
'market_regime': {
    # åŸºç¡€å‚æ•°
    'lookback_period': 30,  # å›çœ‹å‘¨æœŸï¼ˆæ—¥ï¼‰
    'volatility_period': 14,  # æ³¢åŠ¨ç‡è®¡ç®—å‘¨æœŸ
    'confirmation_threshold': 2,  # çŠ¶æ€ç¡®è®¤æ‰€éœ€çš„è¿ç»­å¤©æ•°
    
    # æŠ€æœ¯æŒ‡æ ‡æƒé‡
    'indicators': {
        'price_change_weight': 0.5,  # ä»·æ ¼å˜åŒ–æƒé‡
        'volatility_weight': 0.2,    # æ³¢åŠ¨ç‡æƒé‡
        'trend_strength_weight': 0.2,  # è¶‹åŠ¿å¼ºåº¦æƒé‡
        'momentum_weight': 0.1       # åŠ¨é‡æƒé‡
    },
    
    # åŠ¨æ€è°ƒæ•´å‚æ•°
    'dynamic_adjustment': {
        'enabled': True,
        'adjustment_period': 30,  # è°ƒæ•´å‘¨æœŸï¼ˆæ—¥ï¼‰
        'min_threshold_change': 0.01  # æœ€å°è°ƒæ•´å¹…åº¦
    }
}
```

### 7.3 ä¸ºä»€ä¹ˆé€‰æ‹©30æ—¥ä½œä¸ºåŸºç¡€å‘¨æœŸï¼Ÿ

30æ—¥æ˜¯ä¸€ä¸ªç»è¿‡æµ‹è¯•çš„å¹³è¡¡é€‰æ‹©ï¼š

- **å¤ªçŸ­ï¼ˆå¦‚7æ—¥ï¼‰**: å®¹æ˜“è¢«çŸ­æœŸå™ªéŸ³å¹²æ‰°ï¼Œäº§ç”Ÿè™šå‡ä¿¡å·
- **é€‚ä¸­ï¼ˆ30æ—¥ï¼‰**: èƒ½å¤Ÿåæ˜ ä¸­æœŸè¶‹åŠ¿ï¼ŒåŒæ—¶å¯¹å¸‚åœºå˜åŒ–ä¿æŒè¶³å¤Ÿæ•æ„Ÿ
- **å¤ªé•¿ï¼ˆå¦‚90æ—¥ï¼‰**: å¯¹å¸‚åœºå˜åŒ–ååº”è¿Ÿé’ï¼Œé”™è¿‡é‡è¦è½¬æŠ˜ç‚¹

### 7.4 å¸‚åœºçŠ¶æ€è½¬æ¢è§„åˆ™

å¸‚åœºçŠ¶æ€çš„è½¬æ¢éµå¾ªä¸€å®šçš„è§„åˆ™ï¼Œä»¥é¿å…é¢‘ç¹åˆ‡æ¢ï¼š

1. **çŠ¶æ€ç¡®è®¤**: å¸‚åœºçŠ¶æ€éœ€è¦è¿ç»­`confirmation_threshold`å¤©æ»¡è¶³æ¡ä»¶æ‰ä¼šæ­£å¼åˆ‡æ¢
2. **æ¸è¿›å¼è°ƒæ•´**: èµ„é‡‘åˆ†é…åœ¨çŠ¶æ€è½¬æ¢æ—¶é‡‡ç”¨æ¸è¿›å¼è°ƒæ•´ï¼Œé¿å…å‰§çƒˆæ³¢åŠ¨
3. **å›è¡¥ç¡®è®¤**: å¯¹äºå¿«é€Ÿåè½¬çš„å¸‚åœºçŠ¶æ€ï¼Œç³»ç»Ÿä¼šè¦æ±‚é¢å¤–çš„ç¡®è®¤ä¿¡å·

è¿™ç§è®¾è®¡ä½¿å¾—ç³»ç»Ÿèƒ½å¤Ÿå¹³æ»‘åº”å¯¹å¸‚åœºçŠ¶æ€çš„å˜åŒ–ï¼Œé¿å…å› çŸ­æœŸæ³¢åŠ¨å¯¼è‡´çš„è¿‡åº¦äº¤æ˜“ã€‚

---

## 8. Dockerç¯å¢ƒå‚æ•°

åœ¨Dockerç¯å¢ƒä¸­è¿è¡ŒPrometheusæ—¶ï¼Œå¯ä»¥é€šè¿‡ç¯å¢ƒå˜é‡å’ŒDocker Composeé…ç½®æ¥ç®¡ç†å‚æ•°ã€‚

### 8.1 ç¯å¢ƒå˜é‡é…ç½®

```env
# APIç›¸å…³é…ç½®
OKX_API_KEY=your_api_key_here
OKX_API_SECRET=your_api_secret_here
OKX_API_PASSPHRASE=your_api_passphrase_here

# ç³»ç»Ÿé…ç½®
INITIAL_CAPITAL=5000
INITIAL_AGENTS=5
UPDATE_INTERVAL=60
DRY_RUN=true

# é£é™©æ§åˆ¶
MAX_DAILY_LOSS=0.1
MAX_LEVERAGE=3

# æ—¥å¿—å’Œç›‘æ§
LOG_LEVEL=INFO
ENABLE_METRICS=true
METRICS_PORT=8000
```

### 8.2 Docker Composeé…ç½®ç¤ºä¾‹

```yaml
version: '3.8'

services:
  prometheus:
    image: prometheus:v3.0
    container_name: prometheus_trading
    restart: unless-stopped
    volumes:
      - ./config:/app/config
      - ./logs:/app/logs
      - ./data:/app/data
    environment:
      # ä».envæ–‡ä»¶åŠ è½½ç¯å¢ƒå˜é‡
      - OKX_API_KEY=${OKX_API_KEY}
      - OKX_API_SECRET=${OKX_API_SECRET}
      - OKX_API_PASSPHRASE=${OKX_API_PASSPHRASE}
      - INITIAL_CAPITAL=${INITIAL_CAPITAL:-5000}
      - INITIAL_AGENTS=${INITIAL_AGENTS:-5}
      - MAX_DAILY_LOSS=${MAX_DAILY_LOSS:-0.1}
      - LOG_LEVEL=${LOG_LEVEL:-INFO}
      - DRY_RUN=${DRY_RUN:-true}
    ports:
      - "8000:8000"  # ç›‘æ§æŒ‡æ ‡ç«¯å£
    healthcheck:
      test: ["CMD", "python", "/app/health_check.py"]
      interval: 1m
      timeout: 10s
      retries: 3
    resources:
      limits:
        memory: 2G
        cpus: '1.0'
```

### 8.3 Dockerç‰¹æœ‰å‚æ•°

| å‚æ•° | é»˜è®¤å€¼ | ç±»å‹ | ç¯å¢ƒå˜é‡å | å«ä¹‰ | è°ƒä¼˜å»ºè®® |
|---|---|---|---|---|---|
| `docker_health_check_interval` | 60 | int | - | å¥åº·æ£€æŸ¥é—´éš”ï¼ˆç§’ï¼‰ | å»ºè®®60-300ç§’ã€‚æ ¹æ®ç³»ç»Ÿç¨³å®šæ€§è°ƒæ•´ã€‚ |
| `docker_log_rotation_size` | "100M" | str | - | æ—¥å¿—è½®è½¬å¤§å° | å»ºè®®"100M"-"500M"ã€‚é˜²æ­¢æ—¥å¿—å ç”¨è¿‡å¤šç£ç›˜ç©ºé—´ã€‚ |
| `docker_data_persistence` | true | bool | - | æ˜¯å¦æŒä¹…åŒ–æ•°æ® | ç”Ÿäº§ç¯å¢ƒå»ºè®®å¼€å¯ï¼Œç¡®ä¿æ•°æ®ä¸ä¸¢å¤±ã€‚ |
| `docker_restart_policy` | "unless-stopped" | str | - | å®¹å™¨é‡å¯ç­–ç•¥ | å»ºè®®"unless-stopped"ã€‚ç¡®ä¿ç³»ç»Ÿè‡ªåŠ¨æ¢å¤ã€‚ |

## 9. ç›‘æ§ä¸æ—¥å¿—å‚æ•°

### 9.1 æ—¥å¿—é…ç½®

| å‚æ•° | é»˜è®¤å€¼ | ç±»å‹ | ç¯å¢ƒå˜é‡å | å«ä¹‰ | è°ƒä¼˜å»ºè®® |
|---|---|---|---|---|---|
| `log_level` | "INFO" | str | `LOG_LEVEL` | æ—¥å¿—çº§åˆ« | å¯é€‰ï¼šDEBUG, INFO, WARNING, ERROR, CRITICAL |
| `log_format` | "json" | str | `LOG_FORMAT` | æ—¥å¿—æ ¼å¼ | å¯é€‰ï¼šjson, textã€‚ç”Ÿäº§ç¯å¢ƒæ¨èjsonæ ¼å¼ã€‚ |
| `log_file` | "/app/logs/prometheus.log" | str | `LOG_FILE` | æ—¥å¿—æ–‡ä»¶è·¯å¾„ | Dockerç¯å¢ƒä¸‹å»ºè®®ä½¿ç”¨é»˜è®¤è·¯å¾„ã€‚ |
| `log_rotation` | true | bool | `LOG_ROTATION` | æ˜¯å¦å¼€å¯æ—¥å¿—è½®è½¬ | å»ºè®®å¼€å¯ï¼Œé¿å…æ—¥å¿—æ–‡ä»¶è¿‡å¤§ã€‚ |
| `log_backup_count` | 7 | int | `LOG_BACKUP_COUNT` | ä¿ç•™çš„å†å²æ—¥å¿—æ–‡ä»¶æ•°é‡ | å»ºè®®3-14å¤©ã€‚æ ¹æ®ç£ç›˜ç©ºé—´è°ƒæ•´ã€‚ |

### 9.2 ç›‘æ§æŒ‡æ ‡é…ç½®

```python
'monitoring': {
    'enabled': True,
    'port': 8000,
    'metrics_path': '/metrics',
    'collection_interval': 60,  # æŒ‡æ ‡æ”¶é›†é—´éš”ï¼ˆç§’ï¼‰
    'metrics': {
        'system': True,  # ç³»ç»Ÿèµ„æºæŒ‡æ ‡
        'trading': True,  # äº¤æ˜“æ€§èƒ½æŒ‡æ ‡
        'agents': True,  # Agentè¡¨ç°æŒ‡æ ‡
        'risk': True      # é£é™©æŒ‡æ ‡
    }
}
```

### 9.3 é€šçŸ¥é…ç½®

```python
'notifications': {
    'enabled': True,
    'channels': {
        'email': {
            'enabled': False,
            'smtp_server': '',
            'smtp_port': 587,
            'sender': '',
            'recipients': [],
            'username': '',
            'password': ''
        },
        'telegram': {
            'enabled': False,
            'bot_token': '',
            'chat_id': ''
        }
    },
    'events': {
        'daily_report': True,
        'risk_alerts': True,
        'trade_executions': False,  # å¤§é‡äº¤æ˜“æ—¶å»ºè®®å…³é—­
        'system_status': True
    }
}
```

## 10. è°ƒä¼˜æŒ‡å—

### 10.1 æ–°æ‰‹å…¥é—¨

- **ä¸è¦ä¿®æ”¹ä»»ä½•å‚æ•°**ï¼Œç›´æ¥ä½¿ç”¨é»˜è®¤é…ç½®åœ¨æ¨¡æ‹Ÿç›˜è¿è¡Œè‡³å°‘ä¸€å‘¨
- è§‚å¯Ÿç³»ç»Ÿåœ¨ä¸åŒå¸‚åœºæ¡ä»¶ä¸‹çš„è¡¨ç°ï¼Œäº†è§£åŸºæœ¬è¡Œä¸ºæ¨¡å¼
- ç†Ÿæ‚‰æ—¥å¿—å’Œç›‘æ§è¾“å‡ºï¼Œå­¦ä¼šè§£è¯»ç³»ç»ŸçŠ¶æ€

### 10.2 é£é™©åå¥½è°ƒæ•´

**ä¿å®ˆå‹é…ç½®**
```python
# custom_config.py
def get_custom_config():
    return {
        'risk': {
            'max_daily_loss': 0.05,  # é™ä½åˆ°5%
            'max_leverage': 2,        # é™ä½åˆ°2å€
        },
        'agent_gene_ranges': {
            'risk_aversion': (0.8, 1.5)  # æé«˜é£é™©åŒæ¶ç³»æ•°ä¸‹é™
        }
    }
```

**æ¿€è¿›å‹é…ç½®**
```python
# custom_config.py
def get_custom_config():
    return {
        'risk': {
            'max_daily_loss': 0.15,   # æé«˜åˆ°15%
            'max_leverage': 5,        # æé«˜åˆ°5å€
        },
        'agent_gene_ranges': {
            'risk_aversion': (0.5, 1.2)  # é™ä½é£é™©åŒæ¶ç³»æ•°ä¸Šé™
        }
    }
```

### 10.3 äº¤æ˜“é¢‘ç‡è°ƒæ•´

**é«˜é¢‘äº¤æ˜“é…ç½®**
```python
# ç¼©çŸ­æ›´æ–°é—´éš”
UPDATE_INTERVAL = 30  # ç§’

# è°ƒæ•´åŸºå› èŒƒå›´
'agent_gene_ranges': {
    'long_threshold': (0.03, 0.10),    # é™ä½é˜ˆå€¼ï¼Œæ›´æ˜“è§¦å‘
    'short_threshold': (-0.10, -0.03),
    'holding_period': (120, 1800)      # ç¼©çŸ­æŒä»“æ—¶é—´
}
```

**ä½é¢‘äº¤æ˜“é…ç½®**
```python
# å»¶é•¿æ›´æ–°é—´éš”
UPDATE_INTERVAL = 180  # ç§’

# è°ƒæ•´åŸºå› èŒƒå›´
'agent_gene_ranges': {
    'long_threshold': (0.08, 0.20),    # æé«˜é˜ˆå€¼ï¼Œæ›´éš¾è§¦å‘
    'short_threshold': (-0.20, -0.08),
    'holding_period': (1800, 10800)    # å»¶é•¿æŒä»“æ—¶é—´
}
```

### 10.4 ç­–ç•¥ç±»å‹è°ƒæ•´

**è¶‹åŠ¿è·Ÿè¸ªç­–ç•¥**
```python
'agent_gene_ranges': {
    'holding_period': (3600, 14400),    # 1-4å°æ—¶
    'take_profit': (0.08, 0.20),        # æ›´å¤§çš„æ­¢ç›ˆç›®æ ‡
    'stop_loss': (0.03, 0.06),          # ç›¸å¯¹è¾ƒå°çš„æ­¢æŸ
    'entry_confirmation': (2, 4)        # æ›´å¤šçš„ç¡®è®¤ä¿¡å·
}
```

**éœ‡è¡å¸‚ç­–ç•¥**
```python
'agent_gene_ranges': {
    'holding_period': (300, 1800),      # 5åˆ†é’Ÿ-30åˆ†é’Ÿ
    'take_profit': (0.02, 0.08),        # è¾ƒå°çš„æ­¢ç›ˆç›®æ ‡
    'stop_loss': (0.02, 0.05),          # è¾ƒå°çš„æ­¢æŸ
    'market_regime_weight': (0.5, 0.8)  # æ›´é‡è§†å¸‚åœºçŠ¶æ€
}
```

### 10.5 ç³»ç»Ÿæ€§èƒ½è°ƒä¼˜

å¯¹äºèµ„æºå—é™çš„ç¯å¢ƒï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹å‚æ•°ä¼˜åŒ–æ€§èƒ½ï¼š

```python
# å‡å°‘Agentæ•°é‡
INITIAL_AGENTS = 3
MAX_AGENTS = 6

# å‡å°‘è®¡ç®—é¢‘ç‡
UPDATE_INTERVAL = 120  # å»¶é•¿åˆ°2åˆ†é’Ÿ

# å‡å°‘æ—¥å¿—å’Œç›‘æ§å¼€é”€
'logging': {
    'log_level': 'WARNING',  # æé«˜æ—¥å¿—çº§åˆ«
    'detailed_trade_logs': False
},
'monitoring': {
    'collection_interval': 300  # å»¶é•¿æŒ‡æ ‡æ”¶é›†é—´éš”
}
```

## 11. é…ç½®ç¤ºä¾‹

### 11.1 ä¿å®ˆå‹å®ç›˜é…ç½®

```python
# custom_config.py
def get_custom_config():
    return {
        'initial_capital': 10000,
        'initial_agents': 5,
        'max_agents': 10,
        'update_interval': 60,
        'dry_run': False,
        
        'markets': {
            'spot': {
                'enabled': True,
                'symbol': 'BTC-USDT',
                'allocation': 0.7  # æ›´å¤šèµ„é‡‘é…ç½®åˆ°ç°è´§
            },
            'futures': {
                'enabled': True,
                'symbol': 'BTC-USDT-SWAP',
                'allocation': 0.3,  # è¾ƒå°‘èµ„é‡‘é…ç½®åˆ°åˆçº¦
                'max_leverage': 2   # ä½æ æ†
            }
        },
        
        'risk': {
            'max_daily_trades': 50,
            'max_daily_loss': 0.05,
            'max_drawdown': 0.15,
            'max_leverage': 2,
            'max_position_pct': 0.2,
            'close_positions_on_risk': True
        },
        
        'agent_gene_ranges': {
            'risk_aversion': (0.8, 1.5),
            'stop_loss': (0.03, 0.06),
            'holding_period': (1800, 7200)
        },
        
        'logging': {
            'log_level': 'INFO',
            'log_format': 'json'
        },
        
        'notifications': {
            'enabled': True,
            'channels': {
                'telegram': {
                    'enabled': True,
                    'bot_token': 'your_token',
                    'chat_id': 'your_chat_id'
                }
            },
            'events': {
                'daily_report': True,
                'risk_alerts': True,
                'trade_executions': True
            }
        }
    }
```

### 11.2 Dockerç”Ÿäº§ç¯å¢ƒé…ç½®

```yaml
# docker-compose.yml
version: '3.8'

services:
  prometheus:
    image: prometheus:v3.0
    container_name: prometheus_trading
    restart: unless-stopped
    volumes:
      - ./config:/app/config
      - prometheus_logs:/app/logs
      - prometheus_data:/app/data
    environment:
      - OKX_API_KEY=${OKX_API_KEY}
      - OKX_API_SECRET=${OKX_API_SECRET}
      - OKX_API_PASSPHRASE=${OKX_API_PASSPHRASE}
      - INITIAL_CAPITAL=20000
      - INITIAL_AGENTS=7
      - MAX_AGENTS=14
      - UPDATE_INTERVAL=60
      - DRY_RUN=false
      - MAX_DAILY_LOSS=0.08
      - MAX_LEVERAGE=3
      - LOG_LEVEL=INFO
    ports:
      - "8000:8000"
    healthcheck:
      test: ["CMD", "python", "/app/health_check.py"]
      interval: 1m
      timeout: 10s
      retries: 3
    resources:
      limits:
        memory: 4G
        cpus: '2.0'

  prometheus_monitor:
    image: prom/prometheus:latest
    container_name: prometheus_monitor
    restart: unless-stopped
    volumes:
      - ./monitoring/prometheus.yml:/etc/prometheus/prometheus.yml
      - prometheus_metrics:/prometheus
    ports:
      - "9090:9090"
    depends_on:
      - prometheus

volumes:
  prometheus_logs:
  prometheus_data:
  prometheus_metrics:
```

## 12. æœ€ä½³å®è·µ

### 12.1 å‚æ•°è°ƒä¼˜åŸåˆ™

1.  **æ¸è¿›å¼è°ƒæ•´**ï¼šä¸è¦ä¸€æ¬¡æ€§ä¿®æ”¹å¤šä¸ªé‡è¦å‚æ•°
2.  **æ•°æ®é©±åŠ¨**ï¼šæ¯æ¬¡è°ƒæ•´éƒ½åº”æœ‰æ˜ç¡®çš„æ•°æ®æ”¯æŒå’Œé¢„æœŸ
3.  **æ¨¡æ‹Ÿå…ˆè¡Œ**ï¼šæ–°å‚æ•°ç»„åˆå¿…é¡»å…ˆåœ¨æ¨¡æ‹Ÿç›˜éªŒè¯è‡³å°‘ä¸€å‘¨
4.  **ä¿å®ˆèµ·æ­¥**ï¼šå®ç›˜åˆæœŸä½¿ç”¨ç›¸å¯¹ä¿å®ˆçš„å‚æ•°è®¾ç½®
5.  **æŒç»­è®°å½•**ï¼šè¯¦ç»†è®°å½•æ¯æ¬¡è°ƒæ•´åŠå…¶æ•ˆæœ

### 12.2 ä¸åŒå¸‚åœºç¯å¢ƒçš„å‚æ•°è°ƒæ•´

| å¸‚åœºç¯å¢ƒ | é£é™©å‚æ•°è°ƒæ•´ | AgentåŸºå› è°ƒæ•´ | å…¶ä»–å»ºè®® |
|---|---|---|---|
| **é«˜æ³¢åŠ¨æœŸ** | é™ä½`max_daily_loss`<br>é™ä½`max_leverage`<br>å‡å°‘`max_position_pct` | æé«˜`stop_loss`<br>é™ä½`take_profit`<br>æé«˜`risk_aversion` | å»¶é•¿`update_interval`<br>å¯ç”¨ç†”æ–­æœºåˆ¶ |
| **ä½æ³¢åŠ¨æœŸ** | ä¿æŒé»˜è®¤å€¼ | é™ä½`long_threshold`/`short_threshold`<br>ç¼©çŸ­`holding_period` | å¢åŠ `initial_agents`<br>æé«˜å˜å¼‚ç‡ |
| **è¶‹åŠ¿æ˜ç¡®æœŸ** | å¯é€‚å½“æ”¾å®½`max_daily_loss` | å»¶é•¿`holding_period`<br>æé«˜`take_profit` | è°ƒæ•´å¸‚åœºæƒé‡ï¼Œå¢åŠ è¶‹åŠ¿è·Ÿè¸ªAgentæ¯”ä¾‹ |
| **éœ‡è¡æ•´ç†æœŸ** | é™ä½`max_position_pct` | å¢åŠ `entry_confirmation`<br>ç¼©å°`take_profit`/`stop_loss` | å¯ç”¨åŠ¨æ€ä»“ä½è°ƒæ•´ |

### 12.3 æ€§èƒ½ä¸ç¨³å®šæ€§å¹³è¡¡

åœ¨é…ç½®ç³»ç»Ÿæ—¶ï¼Œéœ€è¦åœ¨æ€§èƒ½å’Œç¨³å®šæ€§ä¹‹é—´æ‰¾åˆ°å¹³è¡¡ç‚¹ï¼š

- **æé«˜æ€§èƒ½çš„é…ç½®**é€šå¸¸ä¼šå¢åŠ ç³»ç»Ÿèµ„æºæ¶ˆè€—å’Œé£é™©
- **æé«˜ç¨³å®šæ€§çš„é…ç½®**é€šå¸¸ä¼šé™ä½äº¤æ˜“é¢‘ç‡å’Œæ½œåœ¨æ”¶ç›Š

æ ¹æ®æ‚¨çš„é£é™©åå¥½å’Œç¡¬ä»¶æ¡ä»¶ï¼Œé€‰æ‹©åˆé€‚çš„é…ç½®å¹³è¡¡ç‚¹ã€‚

## 13. å¸¸è§é—®é¢˜è§£ç­”

### 13.1 å¦‚ä½•ç¡®å®šæœ€ä¼˜çš„Agentæ•°é‡ï¼Ÿ

**ç­”**ï¼šAgentæ•°é‡å–å†³äºæ‚¨çš„è®¡ç®—èµ„æºå’Œå¸‚åœºå¤æ‚åº¦ï¼š
- èµ„æºæœ‰é™ï¼šå»ºè®®5-8ä¸ªAgent
- èµ„æºå……è¶³ï¼šå¯ä»¥å°è¯•10-20ä¸ªAgent
- åˆå§‹é˜¶æ®µï¼šä»è¾ƒå°‘æ•°é‡å¼€å§‹ï¼Œé€æ­¥å¢åŠ 
- è®°ä½ï¼š**è´¨é‡ä¼˜äºæ•°é‡**ï¼Œ10ä¸ªç²¾å¿ƒè®¾è®¡çš„Agentå¯èƒ½æ¯”20ä¸ªéšæœºAgentè¡¨ç°æ›´å¥½

### 13.2 ä¸ºä»€ä¹ˆæˆ‘çš„ç³»ç»Ÿåœ¨éœ‡è¡å¸‚è¡¨ç°ä¸ä½³ï¼Ÿ

**ç­”**ï¼šè¿™æ˜¯å¸¸è§é—®é¢˜ï¼Œå¯èƒ½çš„è§£å†³æ–¹æ³•ï¼š
1. è°ƒæ•´å¸‚åœºçŠ¶æ€æ£€æµ‹å‚æ•°ï¼Œæé«˜éœ‡è¡å¸‚è¯†åˆ«å‡†ç¡®ç‡
2. å¢åŠ `entry_confirmation`å€¼ï¼Œå‡å°‘å‡çªç ´å…¥åœº
3. ç¼©å°`take_profit`å’Œ`stop_loss`èŒƒå›´ï¼Œé€‚åº”å°æ³¢åŠ¨
4. å¯ç”¨åŠ¨æ€ä»“ä½è°ƒæ•´ï¼Œåœ¨éœ‡è¡å¸‚è‡ªåŠ¨é™ä½ä»“ä½

### 13.3 Dockerç¯å¢ƒå’Œæœ¬åœ°ç¯å¢ƒå‚æ•°è®¾ç½®æœ‰åŒºåˆ«å—ï¼Ÿ

**ç­”**ï¼šåŸºæœ¬å‚æ•°è®¾ç½®ç›¸åŒï¼Œä½†Dockerç¯å¢ƒæœ‰å‡ ç‚¹ç‰¹æ®Šè€ƒè™‘ï¼š
1. èµ„æºé™åˆ¶ï¼šè®¾ç½®é€‚å½“çš„å†…å­˜å’ŒCPUé™åˆ¶
2. ç¯å¢ƒå˜é‡ï¼šæ•æ„Ÿä¿¡æ¯ï¼ˆå¦‚APIå¯†é’¥ï¼‰åº”é€šè¿‡ç¯å¢ƒå˜é‡ä¼ å…¥
3. æ•°æ®æŒä¹…åŒ–ï¼šç¡®ä¿å…³é”®æ•°æ®é€šè¿‡å·æŒ‚è½½æŒä¹…åŒ–
4. å¥åº·æ£€æŸ¥ï¼šé…ç½®é€‚å½“çš„å¥åº·æ£€æŸ¥å‚æ•°

### 13.4 å¦‚ä½•é…ç½®å¤šäº¤æ˜“å¯¹ï¼Ÿ

**ç­”**ï¼šåœ¨`markets`é…ç½®ä¸­ä½¿ç”¨`symbols`æ•°ç»„è€Œä¸æ˜¯å•ä¸ª`symbol`ï¼š
```python
'markets': {
    'spot': {
        'enabled': True,
        'symbols': [
            {'pair': 'BTC-USDT', 'allocation': 0.4},
            {'pair': 'ETH-USDT', 'allocation': 0.3},
            {'pair': 'SOL-USDT', 'allocation': 0.3}
        ]
    }
}
```

### 13.5 å‚æ•°è°ƒä¼˜éœ€è¦å¤šé•¿æ—¶é—´ï¼Ÿ

**ç­”**ï¼šå‚æ•°è°ƒä¼˜æ˜¯ä¸€ä¸ªæŒç»­çš„è¿‡ç¨‹ï¼š
- åˆæ­¥é€‚åº”æœŸï¼šè‡³å°‘1-2å‘¨çš„æ¨¡æ‹Ÿç›˜è¿è¡Œ
- åŸºç¡€è°ƒä¼˜ï¼š1-2ä¸ªæœˆçš„å®ç›˜è§‚å¯Ÿå’Œè°ƒæ•´
- æŒç»­ä¼˜åŒ–ï¼šç³»ç»Ÿè¿è¡ŒæœŸé—´çš„å®šæœŸè¯„ä¼°å’Œå¾®è°ƒ

> **é‡è¦æç¤º**ï¼šå‚æ•°è°ƒä¼˜æ²¡æœ‰ç»ˆç‚¹ï¼Œå¸‚åœºåœ¨ä¸æ–­å˜åŒ–ï¼Œç­–ç•¥ä¹Ÿéœ€è¦æŒç»­é€‚åº”ã€‚ä¿æŒè€å¿ƒï¼Œå…³æ³¨é•¿æœŸè¡¨ç°è€ŒéçŸ­æœŸæ³¢åŠ¨ã€‚

---

*æœ¬æ–‡æ¡£ç”±Prometheuså¼€å‘å›¢é˜Ÿç»´æŠ¤*
*æœ€åæ›´æ–°: 2025å¹´11æœˆ29æ—¥*

*æœ¬æ–‡æ¡£ç”±AIç”Ÿæˆå¹¶ç”±äººå·¥ä¼˜åŒ–*  
*æœ€åæ›´æ–°: 2025-11-29*
