# Prometheus v6.0 æ¶æ„æ–‡æ¡£

**Version**: 6.0.0  
**Date**: 2025-12-08  
**Status**: Development  
**Philosophy**: AlphaZero Era - ç›¸å¯¹æœ€ä¼˜è§£

---

## ğŸ“‹ ç›®å½•

1. [æ ¸å¿ƒç›®æ ‡](#æ ¸å¿ƒç›®æ ‡)
2. [è®¾è®¡å“²å­¦](#è®¾è®¡å“²å­¦)
3. [ä¸‰å¤§é“å¾‹](#ä¸‰å¤§é“å¾‹)
4. [æ¶æ„æ¦‚è§ˆ](#æ¶æ„æ¦‚è§ˆ)
5. [æ ¸å¿ƒç»„ä»¶](#æ ¸å¿ƒç»„ä»¶)
6. [æ•°æ®æµ](#æ•°æ®æµ)
7. [APIæ¥å£](#apiæ¥å£)
8. [ä¸v5.xçš„å·®å¼‚](#ä¸v5xçš„å·®å¼‚)

---

## ğŸ¯ æ ¸å¿ƒç›®æ ‡

Prometheus v6.0çš„å”¯ä¸€ç›®æ ‡æ˜¯**ç›ˆåˆ©**ï¼Œå…·ä½“è¡¨ç°ä¸ºï¼š

```
1. ç‰›å¸‚è·‘èµ¢BTCï¼ˆä¾‹å¦‚ï¼šBTC +536%ï¼ŒPrometheus +600%+ï¼‰
2. ç†Šå¸‚åšç©ºç›ˆåˆ©ï¼ˆä¾‹å¦‚ï¼šBTC -50%ï¼ŒPrometheus +20%+ï¼‰
3. éœ‡è¡å¸‚å°æ³¢æ®µç›ˆåˆ©ï¼ˆä¾‹å¦‚ï¼šBTC 0%ï¼ŒPrometheus +20%+ï¼‰
4. å´©ç›˜æ—¶åŠæ—¶é€ƒç¦»ï¼ˆä¾‹å¦‚ï¼šBTC -80%ï¼ŒPrometheus -10%ä»¥å†…ï¼‰
```

### æˆåŠŸæ ‡å‡†ï¼ˆç›¸å¯¹æœ€ä¼˜è§£ï¼‰

**ä¸æ˜¯è¿™äº›ï¼ˆå®Œç¾è§£çš„é™·é˜±ï¼‰ï¼š**
- âŒ é¢„æµ‹å‡†ç¡®ç‡100%
- âŒ æ°¸è¿œä¸äºæŸ
- âŒ æ¯ç¬”äº¤æ˜“éƒ½èµšé’±

**è€Œæ˜¯è¿™äº›ï¼ˆç›¸å¯¹æœ€ä¼˜è§£ï¼‰ï¼š**
- âœ… é•¿æœŸè·‘èµ¢BTCï¼ˆå¤æ™®æ¯”ç‡ > 1.5ï¼‰
- âœ… æœ€å¤§å›æ’¤ < 30%
- âœ… å››ç§å¸‚åœºéƒ½èƒ½ç›ˆåˆ©ï¼ˆå…¨å¤©å€™ç­–ç•¥ï¼‰
- âœ… æŒç»­å­¦ä¹ å’Œè¿›åŒ–

---

## ğŸ’¡ è®¾è®¡å“²å­¦

### 1. ç›¸å¯¹æœ€ä¼˜è§£ç†è®º

**æ ¸å¿ƒæ´å¯Ÿï¼š**
- å›´æ£‹çŠ¶æ€ç©ºé—´ï¼š10^172ï¼Œå®Œç¾è§£åœ¨ç‰©ç†ä¸Šä¸å¯è¾¾
- é‡‘èå¸‚åœºï¼šçŠ¶æ€ç©ºé—´æ— é™ï¼Œä¸”éå¹³ç¨³ã€ä¸å®Œå…¨ä¿¡æ¯ã€å……æ»¡éšæœºæ€§
- å› æ­¤ï¼š**ä¸è¿½æ±‚å®Œç¾è§£ï¼Œè¿½æ±‚ç›¸å¯¹æœ€ä¼˜è§£**

**å®è·µæŒ‡å¯¼ï¼š**
```
âœ… ä¸è¿½æ±‚å®Œç¾ï¼Œè¿½æ±‚æ›´å¥½
âœ… ä¸è¿½æ±‚å¤æ‚ï¼Œè¿½æ±‚æœ‰æ•ˆ
âœ… ä¸è¿½æ±‚åˆ›æ–°ï¼Œè¿½æ±‚ç›ˆåˆ©
âœ… Done is better than perfect
```

### 2. AlphaZeroå¼ç®€åŒ– + æ™ºèƒ½åˆ›ä¸–

**ç®€åŒ–éƒ¨åˆ†ï¼ˆv5.x â†’ v6.0ï¼‰ï¼š**
- âŒ ç§»é™¤Instinct/Emotion â†’ âœ… ä½¿ç”¨StrategyParamsï¼ˆå®¢è§‚å‚æ•°ï¼‰
- âŒ ç§»é™¤Immigrationæœºåˆ¶ â†’ âœ… è‡ªç„¶æ¼”åŒ–
- âŒ ç§»é™¤TieråŸºå› è§£é” â†’ âœ… 50å‚æ•°å…¨å¼€æ”¾
- âŒ å¤æ‚é€‚åº”åº¦å…¬å¼ â†’ âœ… ç»å¯¹åˆ©æ¶¦

**æ™ºèƒ½éƒ¨åˆ†ï¼ˆæ–°å¢ï¼‰ï¼š**
- âœ… WorldSignature V3ï¼ˆè¿‡å»+å½“ä¸‹+æœªæ¥ï¼‰
- âœ… MemoryLayerï¼ˆç»éªŒç§¯ç´¯ï¼‰
- âœ… æ™ºèƒ½åˆ›ä¸–ï¼ˆåŸºäºå†å²æœ€ä¼˜ï¼‰
- âœ… æŒç»­å­¦ä¹ ï¼ˆä¸æ–­é€¼è¿‘æœ€ä¼˜è§£ï¼‰

### 3. ä¸‰å¤§é“å¾‹å¼ºåˆ¶æ‰§è¡Œ

v6.0å°†ä¸‰å¤§é“å¾‹å†…ç½®åˆ°æ¶æ„ä¸­ï¼Œä¸å¯ç»•è¿‡ï¼š
1. **ç»Ÿä¸€å°è£…** â†’ Facadeæ˜¯å”¯ä¸€å…¥å£ï¼Œåº•å±‚æ¨¡å—æ ‡è®°ä¸ºç§æœ‰
2. **æµ‹è¯•è§„èŒƒ** â†’ å¼ºåˆ¶æ¨¡æ¿ï¼ŒCIæ£€æŸ¥
3. **å®Œæ•´æœºåˆ¶** â†’ è‡ªåŠ¨å¯¹è´¦ï¼ŒåŸå­æ“ä½œ

---

## ğŸ”’ ä¸‰å¤§é“å¾‹

### é“å¾‹1: ç»Ÿä¸€å°è£…ï¼Œç»Ÿä¸€è°ƒç”¨ï¼Œä¸¥ç¦æ—è·¯

**åŸåˆ™ï¼š**
- æ‰€æœ‰åœºæ™¯å¿…é¡»é€šè¿‡`build_facade()` + `run_scenario()`
- ä¸¥ç¦è‡ªå·±å†™å¾ªç¯ç›´æ¥è°ƒç”¨åº•å±‚æ¨¡å—
- ä¸¥ç¦ç»•è¿‡Facadeç›´æ¥æ“ä½œMoirai/EvolutionManager

**å®æ–½ï¼š**
```python
# âœ… æ­£ç¡®ï¼ˆå¼ºåˆ¶ï¼‰
from prometheus.v6 import build_facade, run_scenario

facade = build_facade(market_data, config, scenario='backtest')
results = run_scenario(facade, max_cycles=500)

# âŒ é”™è¯¯ï¼ˆç¦æ­¢ï¼‰
from prometheus.v6._core._moirai import Moirai  # ä¸èƒ½ç›´æ¥å¯¼å…¥
moirai = Moirai(...)  # ä¸èƒ½ç›´æ¥åˆ›å»º
for cycle in range(500):  # ä¸èƒ½è‡ªå·±å†™å¾ªç¯
    moirai.run_cycle(...)
```

**å¼ºåˆ¶æœºåˆ¶ï¼š**
- åº•å±‚æ¨¡å—æ–‡ä»¶åå‰ç¼€`_`ï¼ˆä¾‹å¦‚`_moirai.py`ï¼‰
- `__init__.py`ä¸å¯¼å‡ºåº•å±‚ç±»
- æ–‡æ¡£æ˜ç¡®è­¦å‘Š

### é“å¾‹2: ä¸¥æ ¼æ‰§è¡Œæµ‹è¯•è§„èŒƒ

**åŸåˆ™ï¼š**
- `templates/STANDARD_TEST_TEMPLATE_V6.py`æ˜¯å”¯ä¸€æ ‡å‡†
- æ‰€æœ‰æµ‹è¯•å¿…é¡»åŸºäºæ­¤æ¨¡æ¿
- æ¨¡æ¿åŒ…å«ï¼šå®Œæ•´æ¶æ„åˆå§‹åŒ–ã€åŒè´¦ç°¿æŒ‚è½½éªŒè¯ã€å¯¹è´¦éªŒè¯

**å®æ–½ï¼š**
```python
# âœ… æ­£ç¡®ï¼ˆå¼ºåˆ¶ï¼‰
# å¤åˆ¶æ¨¡æ¿ï¼Œå¡«å†™å‚æ•°
from prometheus.v6 import build_facade, run_scenario
facade = build_facade(...)  # æ ‡å‡†å…¥å£
results = run_scenario(...)  # æ ‡å‡†è¿è¡Œ
# è‡ªåŠ¨å¯¹è´¦ï¼ˆæ¨¡æ¿å†…ç½®ï¼‰

# âŒ é”™è¯¯ï¼ˆç¦æ­¢ï¼‰
# è‡ªåˆ›ç®€åŒ–ç‰ˆæµ‹è¯•
agents = [AgentV5() for _ in range(50)]  # ç®€åŒ–åˆå§‹åŒ–
for cycle in range(500):  # è‡ªå·±å†™å¾ªç¯
    # ... çœç•¥è¿›åŒ–ã€å¯¹è´¦ç­‰
```

**å¼ºåˆ¶æœºåˆ¶ï¼š**
- CIæ£€æŸ¥æ‰€æœ‰`test_*.py`å¿…é¡»ç¬¦åˆæ¨¡æ¿
- ä¸ç¬¦åˆ â†’ æµ‹è¯•å¤±è´¥

### é“å¾‹3: ä¸å¯ä¸ºæµ‹è¯•é€šè¿‡è€Œç®€åŒ–åº•å±‚æœºåˆ¶

**åŸåˆ™ï¼š**
- æµ‹è¯•å¿…é¡»ä½¿ç”¨å®Œæ•´çš„äº¤æ˜“ç”Ÿå‘½å‘¨æœŸï¼ˆå¼€ä»“â†’æŒä»“â†’å¹³ä»“ï¼‰
- å®Œæ•´çš„è´¦ç°¿ç³»ç»Ÿï¼ˆä¸æ‰‹åŠ¨ä¿®æ”¹current_capitalï¼‰
- å®Œæ•´çš„è¿›åŒ–æœºåˆ¶ï¼ˆé€‰æ‹©ã€ç¹æ®–ã€å˜å¼‚ã€æ·˜æ±°ï¼‰

**å®æ–½ï¼š**
```python
# âœ… æ­£ç¡®ï¼ˆå¼ºåˆ¶ï¼‰
# Moirai.match_trade() æ˜¯å”¯ä¸€äº¤æ˜“å…¥å£
# å¼ºåˆ¶åŒ…å«: é£æ§ â†’ æ‰§è¡Œ â†’ è®°å½•ç§è´¦ â†’ è®°å½•å…¬è´¦
# AgentAccountSystem.record_trade() å†…ç½®è‡ªåŠ¨å¯¹è´¦

# âŒ é”™è¯¯ï¼ˆç¦æ­¢ï¼‰
agent.current_capital += 1000  # æ‰‹åŠ¨ä¿®æ”¹ï¼ˆç¦æ­¢ï¼‰
private_ledger.record(...)  # å•ç‹¬è°ƒç”¨ï¼ˆç¦æ­¢ï¼‰
# ä¸è°ƒç”¨å¯¹è´¦ï¼ˆç¦æ­¢ï¼‰
```

**å¼ºåˆ¶æœºåˆ¶ï¼š**
- `AgentAccountSystem.record_trade()`å†…ç½®å¯¹è´¦
- æ¯ç¬”äº¤æ˜“éƒ½ä¼šè‡ªåŠ¨éªŒè¯ç§è´¦=å…¬è´¦
- ä¸ä¸€è‡´ â†’ ç«‹å³æŠ›å‡ºå¼‚å¸¸

---

## ğŸ—ï¸ æ¶æ„æ¦‚è§ˆ

### ç›®å½•ç»“æ„

```
prometheus/
â”œâ”€â”€ v6/                          # v6.0ä¸“å±ç›®å½•
â”‚   â”œâ”€â”€ __init__.py              # å”¯ä¸€å¯¹å¤–æ¥å£ï¼šbuild_facade, run_scenario
â”‚   â”œâ”€â”€ facade.py                # V6Facadeï¼ˆç»Ÿä¸€å…¥å£ï¼‰
â”‚   â”œâ”€â”€ config.py                # é…ç½®ç±»
â”‚   â”‚
â”‚   â”œâ”€â”€ _core/                   # æ ¸å¿ƒæ¨¡å—ï¼ˆç§æœ‰ï¼‰
â”‚   â”‚   â”œâ”€â”€ _agent.py            # Agentå®šä¹‰
â”‚   â”‚   â”œâ”€â”€ _moirai.py           # Agentç”Ÿå‘½å‘¨æœŸç®¡ç†
â”‚   â”‚   â”œâ”€â”€ _evolution.py        # è¿›åŒ–ç®¡ç†
â”‚   â”‚   â””â”€â”€ _capital_pool.py     # èµ„é‡‘æ± 
â”‚   â”‚
â”‚   â”œâ”€â”€ world_signature/         # å¸‚åœºæ„ŸçŸ¥
â”‚   â”‚   â”œâ”€â”€ signature_v3.py      # WorldSignature V3
â”‚   â”‚   â”œâ”€â”€ history.py           # HistoryContext
â”‚   â”‚   â”œâ”€â”€ future_signals.py    # FutureSignals
â”‚   â”‚   â””â”€â”€ prophet.py           # Prophetï¼ˆè®¡ç®—WSï¼‰
â”‚   â”‚
â”‚   â”œâ”€â”€ memory/                  # è®°å¿†å±‚
â”‚   â”‚   â”œâ”€â”€ experience_db.py     # ç»éªŒæ•°æ®åº“
â”‚   â”‚   â””â”€â”€ intelligent_genesis.py # æ™ºèƒ½åˆ›ä¸–
â”‚   â”‚
â”‚   â””â”€â”€ ledger/                  # è´¦ç°¿ç³»ç»Ÿ
â”‚       â”œâ”€â”€ private_ledger.py
â”‚       â”œâ”€â”€ public_ledger.py
â”‚       â””â”€â”€ account_system.py    # è‡ªåŠ¨å¯¹è´¦
â”‚
â”œâ”€â”€ templates/
â”‚   â””â”€â”€ STANDARD_TEST_TEMPLATE_V6.py
â”‚
â””â”€â”€ docs/
    â”œâ”€â”€ V6_ARCHITECTURE.md       # æœ¬æ–‡æ¡£
    â”œâ”€â”€ V6_THREE_IRON_RULES.md   # ä¸‰å¤§é“å¾‹è¯¦è§£
    â””â”€â”€ V6_MIGRATION_GUIDE.md    # è¿ç§»æŒ‡å—
```

### å±‚æ¬¡ç»“æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         ç”¨æˆ·/æµ‹è¯•ä»£ç                       â”‚
â”‚  import from prometheus.v6              â”‚
â”‚  build_facade() + run_scenario()       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚ å”¯ä¸€å…¥å£
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         V6Facadeï¼ˆç»Ÿä¸€å°è£…å±‚ï¼‰             â”‚
â”‚  - åœºæ™¯é€‰æ‹©ï¼ˆbacktest/mock/live_demoï¼‰    â”‚
â”‚  - ç»„ä»¶åˆå§‹åŒ–                             â”‚
â”‚  - ç”Ÿå‘½å‘¨æœŸç®¡ç†                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”
      â–¼        â–¼        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Prophet  â”‚ â”‚Moirai â”‚ â”‚ Evolution  â”‚
â”‚ (WS V3)  â”‚ â”‚(äº¤æ˜“) â”‚ â”‚  Manager   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚         â”‚           â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚   MemoryLayer           â”‚
   â”‚ - ExperienceDB          â”‚
   â”‚ - IntelligentGenesis    â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
                â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚   LedgerSystem          â”‚
   â”‚ - è‡ªåŠ¨å¯¹è´¦               â”‚
   â”‚ - åŸå­æ“ä½œ               â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ§© æ ¸å¿ƒç»„ä»¶

### 1. V6Facadeï¼ˆç»Ÿä¸€å…¥å£ï¼‰

**èŒè´£ï¼š**
- ç³»ç»Ÿå”¯ä¸€å…¥å£
- ç»„ä»¶åˆå§‹åŒ–å’Œä¾èµ–æ³¨å…¥
- åœºæ™¯é€‰æ‹©å’Œç”Ÿå‘½å‘¨æœŸç®¡ç†
- å¼ºåˆ¶ä¸‰å¤§é“å¾‹æ‰§è¡Œ

**æ ¸å¿ƒæ–¹æ³•ï¼š**
```python
def build_facade(
    market_data: pd.DataFrame,
    config: SystemCapitalConfig,
    scenario: str,  # 'backtest', 'mock', 'live_demo'
    seed: Optional[int] = None,
    use_intelligent_genesis: bool = True,
    experience_db_path: str = "data/experience_db.json"
) -> V6Facade:
    """
    æ„å»ºFacadeå®ä¾‹ï¼ˆå”¯ä¸€å…¥å£ï¼‰
    
    å¼ºåˆ¶æ‰§è¡Œï¼š
      - é“å¾‹1: æ‰€æœ‰ç»„ä»¶é€šè¿‡æ­¤å¤„åˆå§‹åŒ–
      - é“å¾‹2: æ ‡å‡†åˆå§‹åŒ–æµç¨‹
      - é“å¾‹3: å®Œæ•´ç»„ä»¶ä¸å¯çœç•¥
    """
    pass

def run_scenario(
    facade: V6Facade,
    max_cycles: int,
    breeding_tax_rate: Optional[float] = None,
    evolution_interval: int = 50
) -> Dict:
    """
    è¿è¡Œåœºæ™¯ï¼ˆå”¯ä¸€å…¥å£ï¼‰
    
    å¼ºåˆ¶æ‰§è¡Œï¼š
      - é“å¾‹1: æ‰€æœ‰åœºæ™¯é€šè¿‡æ­¤å¤„è¿è¡Œ
      - é“å¾‹2: æ ‡å‡†è¿è¡Œæµç¨‹
      - é“å¾‹3: è‡ªåŠ¨å¯¹è´¦ã€å®Œæ•´ç”Ÿå‘½å‘¨æœŸ
    """
    pass
```

### 2. WorldSignature V3ï¼ˆè¿‡å»+å½“ä¸‹+æœªæ¥ï¼‰

**ç»“æ„ï¼š**
```python
@dataclass
class WorldSignature_V3:
    # åŸºæœ¬ä¿¡æ¯
    id: str
    timestamp: float
    instrument: str
    
    # è¿‡å»ï¼ˆHistoryï¼‰
    history: HistoryContext
        - price_percentile: float      # ä»·æ ¼å†å²ç™¾åˆ†ä½
        - historical_high/low: float
        - distance_from_high/low: float
        - volatility_ratio: float      # å½“å‰æ³¢åŠ¨ç‡/å†å²å¹³å‡
        - volume_ratio: float
    
    # å½“ä¸‹ï¼ˆPresentï¼‰
    macro: MacroCode                   # å®è§‚ç¼–ç ï¼ˆ128-dimï¼‰
    micro: MicroCode                   # å¾®è§‚ç¼–ç ï¼ˆ256-dimï¼‰
    regime_id: str                     # å¸‚åœºçŠ¶æ€è¯†åˆ«
    
    # æœªæ¥ï¼ˆFuture Signalsï¼‰
    future_signals: FutureSignals
        - momentum_divergence: float   # åŠ¨é‡èƒŒç¦»
        - volume_divergence: float     # æˆäº¤é‡èƒŒç¦»
        - volatility_increasing: bool
        - liquidity_decreasing: bool
        - reversal_signal_strength: float  # åè½¬ä¿¡å·å¼ºåº¦ï¼ˆ0-1ï¼‰
        - danger_level: str            # 'LOW', 'MEDIUM', 'HIGH', 'CRITICAL'
    
    # è¯„åˆ†
    novelty_score: float
    stability_score: float
    danger_index: float
    opportunity_index: float
```

**å…³é”®ï¼š**
- **è¿‡å»**ï¼šæä¾›èƒŒæ™¯ï¼Œåˆ¤æ–­å½“å‰æ˜¯"é«˜ä½"è¿˜æ˜¯"ä½ä½"
- **å½“ä¸‹**ï¼šæä¾›äº‹å®ï¼Œå†³ç­–çš„åŸºç¡€
- **æœªæ¥**ï¼šæä¾›é¢„è­¦ï¼Œé€šè¿‡é¢†å…ˆæŒ‡æ ‡ï¼ˆä¸æ˜¯é¢„æµ‹æ¨¡å‹ï¼‰

### 3. MemoryLayerï¼ˆç»éªŒç§¯ç´¯ï¼‰

**ExperienceDBï¼š**
```python
class ExperienceDB:
    """
    ç»éªŒæ•°æ®åº“
    å­˜å‚¨: (WorldSignature_V3, Genome, ROI, Sharpe, MaxDrawdown)
    """
    
    def add_experience(
        self,
        ws: WorldSignature_V3,
        genome: GenomeVector,
        roi: float,
        sharpe: float,
        max_drawdown: float,
        segment_id: int
    ):
        """è®°å½•ç»éªŒï¼ˆæ¯50å‘¨æœŸï¼‰"""
        pass
    
    def query_top_k_genomes(
        self,
        ws_current: WorldSignature_V3,
        k: int = 10,
        metric: str = 'roi',
        diversity_threshold: float = 0.3
    ) -> List[GenomeVector]:
        """
        æŸ¥è¯¢æœ€ç›¸ä¼¼çš„WorldSignatureä¸‹çš„Top-Kä¸ªGenome
        
        ç›¸ä¼¼åº¦è®¡ç®—:
          - macro_vecä½™å¼¦ç›¸ä¼¼åº¦ï¼ˆæƒé‡0.4ï¼‰
          - micro_vecä½™å¼¦ç›¸ä¼¼åº¦ï¼ˆæƒé‡0.3ï¼‰
          - Historyç›¸ä¼¼åº¦ï¼ˆæƒé‡0.2ï¼‰
          - FutureSignalsç›¸ä¼¼åº¦ï¼ˆæƒé‡0.1ï¼‰
        
        å¤šæ ·æ€§ä¿è¯:
          - é€‰å‡ºçš„Kä¸ªGenomeä¹‹é—´çš„è·ç¦» > diversity_threshold
        """
        pass
```

**IntelligentGenesisï¼š**
```python
class IntelligentGenesis:
    """
    æ™ºèƒ½åˆ›ä¸–ç®¡ç†å™¨
    æ ¹æ®åˆå§‹å¸‚åœºç¯å¢ƒå’Œå†å²ç»éªŒåˆ›å»ºåˆ›ä¸–Agent
    """
    
    def create_genesis_agents(
        self,
        market_data: pd.DataFrame,
        n_total: int = 50,
        elite_ratio: float = 0.30,     # 30%ç²¾è‹±å¤åˆ¶ä½“
        diverse_ratio: float = 0.40,   # 40%å¤šæ ·æ€§Agent
        random_ratio: float = 0.30     # 30%éšæœºæ¢ç´¢
    ) -> List[AgentV5]:
        """
        æ­¥éª¤:
          1. è®¡ç®—åˆå§‹WorldSignature_V3
          2. å†·å¯åŠ¨æ£€æŸ¥ï¼ˆExperienceDBæ˜¯å¦ä¸ºç©ºï¼‰
          3. æŸ¥è¯¢å†å²æœ€ä¼˜Genome
          4. åˆ›å»ºAgentï¼ˆç²¾è‹±+å¤šæ ·æ€§+éšæœºï¼‰
        """
        pass
```

### 4. CapitalPoolï¼ˆèµ„é‡‘ç®¡ç†ï¼‰

**èŒè´£ï¼š**
- ç»Ÿä¸€ç®¡ç†ç³»ç»Ÿèµ„é‡‘
- Agentç¹æ®–æ—¶åˆ†é…å›ºå®šèµ„é‡‘ï¼ˆä¾‹å¦‚$2,000ï¼‰
- Agentæ·˜æ±°æ—¶å›æ”¶èµ„é‡‘
- åŠ¨æ€ç¨ç‡ç»´æŒ80%èµ„é‡‘åˆ©ç”¨ç‡

**æ ¸å¿ƒæ–¹æ³•ï¼š**
```python
class CapitalPool:
    def allocate_to_new_agent(self, amount: float) -> bool:
        """åˆ†é…èµ„é‡‘ç»™æ–°Agent"""
        pass
    
    def reclaim_from_dead_agent(self, amount: float):
        """å›æ”¶æ­»äº¡Agentçš„èµ„é‡‘"""
        pass
    
    def collect_tax(self, amount: float):
        """æ”¶ç¨ï¼ˆç¹æ®–æ—¶ï¼‰"""
        pass
    
    def reconcile(self) -> Dict:
        """
        å¯¹è´¦éªŒè¯
        expected_pool = total_invested - total_allocated + total_reclaimed
        """
        pass
```

### 5. LedgerSystemï¼ˆè‡ªåŠ¨å¯¹è´¦ï¼‰

**æ ¸å¿ƒç‰¹æ€§ï¼š**
- åŒè´¦ç°¿ï¼ˆPrivateLedger + PublicLedgerï¼‰
- è‡ªåŠ¨å¯¹è´¦ï¼ˆæ¯ç¬”äº¤æ˜“ï¼‰
- åŸå­æ“ä½œï¼ˆç§è´¦å…ˆè®°ï¼Œå…¬è´¦åè®°ï¼‰

**AgentAccountSystemï¼š**
```python
class AgentAccountSystem:
    def record_trade(
        self,
        agent: AgentV5,
        action: str,
        amount: float,
        price: float,
        ...
    ):
        """
        è®°å½•äº¤æ˜“ï¼ˆåŸå­æ“ä½œï¼‰
        
        æ­¥éª¤:
          1. è®°å½•ç§è´¦ï¼ˆPrivateLedgerï¼‰
          2. è®°å½•å…¬è´¦ï¼ˆPublicLedgerï¼‰
          3. è‡ªåŠ¨å¯¹è´¦ï¼ˆéªŒè¯ä¸€è‡´æ€§ï¼‰â­
          4. ä¸ä¸€è‡´ â†’ ç«‹å³æŠ›å‡ºå¼‚å¸¸
        """
        # 1. è®°å½•ç§è´¦
        self.private_ledger.record(...)
        
        # 2. è®°å½•å…¬è´¦
        self.public_ledger.record(...)
        
        # 3. è‡ªåŠ¨å¯¹è´¦ï¼ˆé“å¾‹3å¼ºåˆ¶æ‰§è¡Œï¼‰
        self._auto_reconcile(agent)
```

---

## ğŸ”„ æ•°æ®æµ

### 1. åˆ›ä¸–æµç¨‹ï¼ˆæ™ºèƒ½åˆ›ä¸–ï¼‰

```
å¸‚åœºæ•°æ® â†’ Prophet â†’ WorldSignature_V3ï¼ˆåˆå§‹ï¼‰
                              â†“
                    ExperienceDB.query_top_k_genomes()
                              â†“
                    IntelligentGenesis.create_genesis_agents()
                    ï¼ˆ30%ç²¾è‹± + 40%å¤šæ ·æ€§ + 30%éšæœºï¼‰
                              â†“
                    Moirai.add_agents()
```

### 2. äº¤æ˜“æµç¨‹ï¼ˆåŸå­æ“ä½œï¼‰

```
Agent.decide() â†’ Daimon.make_decision() â†’ Moirai.match_trade()
                                              â†“
                                  é£æ§æ£€æŸ¥ï¼ˆæ æ†ã€èµ„é‡‘ï¼‰
                                              â†“
                                  æ‰§è¡Œäº¤æ˜“ï¼ˆåœºæ™¯ç›¸å…³ï¼‰
                                              â†“
                        AgentAccountSystem.record_trade()
                        ï¼ˆç§è´¦ â†’ å…¬è´¦ â†’ è‡ªåŠ¨å¯¹è´¦â­ï¼‰
```

### 3. è¿›åŒ–æµç¨‹ï¼ˆè‡ªç„¶é€‰æ‹©ï¼‰

```
EvolutionManager.run_evolution_cycle()
         â†“
    è¯„ä¼°é€‚åº”åº¦ï¼ˆç»å¯¹åˆ©æ¶¦ï¼‰
         â†“
    é€‰æ‹©ç²¾è‹±ï¼ˆTop 20%ï¼‰
         â†“
    ç¹æ®–ï¼ˆç—…æ¯’å¼å¤åˆ¶ + å˜å¼‚ï¼‰
         â”œâ”€ å¼ºåˆ¶å¹³ä»“
         â”œâ”€ æ”¶ç¨ï¼ˆåŠ¨æ€ç¨ç‡ï¼‰
         â”œâ”€ CapitalPool.allocate_to_new_agent($2,000)
         â””â”€ çˆ¶ä»£èµ„æœ¬ä¸å˜
         â†“
    æ·˜æ±°ï¼ˆBottom 20%ï¼‰
         â””â”€ CapitalPool.reclaim_from_dead_agent()
         â†“
    è®°å½•ç»éªŒï¼ˆæ¯50å‘¨æœŸï¼‰
         â””â”€ ExperienceDB.add_experience()
```

---

## ğŸ”Œ APIæ¥å£

### ç”¨æˆ·çº§APIï¼ˆå”¯ä¸€å¯¹å¤–æ¥å£ï¼‰

```python
from prometheus.v6 import build_facade, run_scenario

# 1. æ„å»ºFacade
facade = build_facade(
    market_data=btc_data,
    config=SystemCapitalConfig(
        total_capital=1000000,
        agent_count=50,
        capital_per_agent=2000,
        genesis_allocation_ratio=0.20
    ),
    scenario='backtest',
    seed=7001,
    use_intelligent_genesis=True,
    experience_db_path="data/experience_db.json"
)

# 2. è¿è¡Œåœºæ™¯
results = run_scenario(
    facade=facade,
    max_cycles=500,
    breeding_tax_rate=None,  # è‡ªåŠ¨è®¡ç®—
    evolution_interval=50
)

# 3. ç»“æœ
print(f"ç³»ç»ŸROI: {results['system_roi']:.2%}")
print(f"Agentå¹³å‡ROI: {results['agent_avg_roi']:.2%}")
print(f"å¯¹è´¦é€šè¿‡ç‡: {results['reconciliation_pass_rate']:.2%}")
```

### ç¦æ­¢çš„APIï¼ˆç§æœ‰æ¨¡å—ï¼‰

```python
# âŒ ç¦æ­¢ç›´æ¥å¯¼å…¥åº•å±‚æ¨¡å—
from prometheus.v6._core._moirai import Moirai  # é”™è¯¯
from prometheus.v6._core._evolution import EvolutionManager  # é”™è¯¯

# âŒ ç¦æ­¢è‡ªå·±å†™å¾ªç¯
for cycle in range(500):  # é”™è¯¯
    facade.run_cycle(...)

# âŒ ç¦æ­¢ç»•è¿‡Facade
moirai = Moirai(...)  # é”™è¯¯
moirai.run_cycle(...)
```

---

## ğŸ”€ ä¸v5.xçš„å·®å¼‚

| ç»´åº¦ | v5.x | v6.0 |
|------|------|------|
| **è®¾è®¡å“²å­¦** | è¿­ä»£ç´¯ç§¯ï¼ŒåŠŸèƒ½å †å  | AlphaZeroå¼ç®€åŒ–+æ™ºèƒ½ |
| **å‘åå…¼å®¹** | å°½é‡å…¼å®¹ | ä¸å…¼å®¹ï¼ˆå¹²å‡€é‡ç”Ÿï¼‰ |
| **ä¸‰å¤§é“å¾‹** | å»ºè®® | å¼ºåˆ¶æ‰§è¡Œ |
| | | |
| **åŸºå› ç³»ç»Ÿ** | 50å‚æ•°+Tierè§£é” | 50å‚æ•°å…¨å¼€æ”¾ |
| **é€‚åº”åº¦** | å¤æ‚å…¬å¼ | ç»å¯¹åˆ©æ¶¦ |
| **Agentç‰¹å¾** | Instinct+Emotion | StrategyParams |
| **ç¹æ®–** | äº¤å‰+å˜å¼‚ | ç—…æ¯’å¼å¤åˆ¶ |
| **å¤šæ ·æ€§** | Immigration | å·²ç§»é™¤ |
| | | |
| **å¸‚åœºæ„ŸçŸ¥** | WorldSignature V2ï¼ˆå½“ä¸‹ï¼‰ | WorldSignature V3ï¼ˆè¿‡å»+å½“ä¸‹+æœªæ¥ï¼‰ |
| **åˆ›ä¸–** | éšæœº | æ™ºèƒ½ï¼ˆåŸºäºå†å²ç»éªŒï¼‰ |
| **è®°å¿†** | æ—  | MemoryLayer |
| | | |
| **èµ„é‡‘ç®¡ç†** | æ—  | CapitalPool |
| **è´¦ç°¿** | æ‰‹åŠ¨å¯¹è´¦ | è‡ªåŠ¨å¯¹è´¦ï¼ˆæ¯ç¬”äº¤æ˜“ï¼‰ |
| **ç¨æ”¶** | æ—  | åŠ¨æ€ç¨ç‡ï¼ˆ80%åˆ©ç”¨ç‡ï¼‰ |
| | | |
| **æ¶æ„** | Facadeï¼ˆå»ºè®®ï¼‰ | Facadeï¼ˆå¼ºåˆ¶å”¯ä¸€ï¼‰ |
| **æµ‹è¯•** | è‡ªç”±å‘æŒ¥ | å¼ºåˆ¶æ¨¡æ¿ |
| **å°è£…** | å»ºè®® | å¼ºåˆ¶ï¼ˆåº•å±‚ç§æœ‰ï¼‰ |

---

## ğŸ“Œ å…³é”®è®¾è®¡å†³ç­–

### 1. ä¸ºä»€ä¹ˆä¸å‘åå…¼å®¹ï¼Ÿ

**ç†ç”±ï¼š**
- v5.xæ˜¯è¿­ä»£ç´¯ç§¯ï¼Œæ¶æ„è‡ƒè‚¿
- ä¸‰å¤§é“å¾‹æ— æ³•åœ¨v5.xåŸºç¡€ä¸Šå¼ºåˆ¶æ‰§è¡Œ
- AlphaZeroå¼ç®€åŒ–éœ€è¦æ¨å€’é‡æ¥
- å‘åå…¼å®¹ä¼šå¯¼è‡´å¦¥åå’Œå¤æ‚æ€§

**ç­–ç•¥ï¼š**
- v6.0æ˜¯ç‹¬ç«‹ç›®å½•ï¼ˆ`prometheus/v6/`ï¼‰
- v5.xä»£ç ä¿ç•™ä½†ä¸å†ç»´æŠ¤
- æä¾›è¿ç§»æŒ‡å—ï¼ˆ`V6_MIGRATION_GUIDE.md`ï¼‰

### 2. ä¸ºä»€ä¹ˆå¼ºåˆ¶Facadeå”¯ä¸€å…¥å£ï¼Ÿ

**ç†ç”±ï¼š**
- v5.xæœ€å¤§é—®é¢˜ï¼šæ¶æ„æ··ä¹±ï¼Œåˆ°å¤„éƒ½æ˜¯æ—è·¯
- æµ‹è¯•ä»£ç è‡ªå·±å†™å¾ªç¯ï¼Œç»•è¿‡æ ¸å¿ƒæœºåˆ¶
- å¯¼è‡´è´¦ç°¿ä¸ä¸€è‡´ã€æ•°æ®å°è£…æ··ä¹±

**è§£å†³æ–¹æ¡ˆï¼š**
- Facadeæ˜¯å”¯ä¸€å…¥å£ï¼ˆbuild_facade + run_scenarioï¼‰
- åº•å±‚æ¨¡å—æ ‡è®°ä¸ºç§æœ‰ï¼ˆæ–‡ä»¶åå‰ç¼€`_`ï¼‰
- `__init__.py`ä¸å¯¼å‡ºåº•å±‚ç±»

### 3. ä¸ºä»€ä¹ˆç§»é™¤Immigrationï¼Ÿ

**ç†ç”±ï¼š**
- Immigrationæ˜¯æ‰‹åŠ¨å¹²é¢„ï¼Œè¿å"è‡ªç„¶æ¼”åŒ–"åŸåˆ™
- å¢åŠ å¤æ‚åº¦ä½†æ•ˆæœä¸æ˜æ˜¾
- AlphaZeroä¸éœ€è¦Immigrationä¹Ÿèƒ½è¿›åŒ–

**æ›¿ä»£æ–¹æ¡ˆï¼š**
- æ™ºèƒ½åˆ›ä¸–ï¼ˆ30%éšæœºAgentä½œä¸ºæ¢ç´¢ï¼‰
- åŸºå› çªå˜ç‡ï¼ˆä¿è¯å¤šæ ·æ€§ï¼‰
- MemoryLayerï¼ˆè®°å½•å¤šæ ·æ€§ç­–ç•¥ï¼‰

### 4. ä¸ºä»€ä¹ˆWorldSignature V3åŒ…å«"æœªæ¥"ï¼Ÿ

**ç†ç”±ï¼š**
- v5.xçš„WS V2åªæœ‰"å½“ä¸‹"ï¼Œå¯¼è‡´Agentå†³ç­–çŸ­è§†
- é‡‘èå¸‚åœºä¸æ˜¯å›´æ£‹ï¼Œæ— æ³•MCTSæ¨¡æ‹Ÿæœªæ¥
- é¢†å…ˆæŒ‡æ ‡ï¼ˆåŠ¨é‡èƒŒç¦»ã€æˆäº¤é‡èƒŒç¦»ï¼‰å¯ä»¥ä½œä¸º"æœªæ¥"çš„ä»£ç†

**è®¾è®¡ï¼š**
- ä¸æ˜¯"é¢„æµ‹æ¨¡å‹"ï¼ˆå¤æ‚ï¼Œéœ€è¦è®­ç»ƒï¼‰
- è€Œæ˜¯"é¢†å…ˆæŒ‡æ ‡"ï¼ˆç®€å•ï¼ŒæŠ€æœ¯åˆ†æï¼‰
- éšå«"æœªæ¥é£é™©"ï¼ŒAgentå¯ä»¥æå‰è§„é¿

---

## ğŸ¯ æ€»ç»“

Prometheus v6.0æ˜¯ä¸€æ¬¡**é‡ç”Ÿ**ï¼Œä¸æ˜¯v5.xçš„å»¶ç»­ï¼š

```
v5.x: è¿­ä»£ç´¯ç§¯ â†’ åŠŸèƒ½å †å  â†’ æ¶æ„è‡ƒè‚¿ â†’ éš¾ä»¥ç»´æŠ¤
v6.0: AlphaZeroå“²å­¦ â†’ ç®€åŒ–+æ™ºèƒ½ â†’ å¼ºåˆ¶è§„èŒƒ â†’ å¯æŒç»­å‘å±•
```

**æ ¸å¿ƒä»·å€¼è§‚ï¼š**
1. **ç›ˆåˆ©è‡³ä¸Š**ï¼šç‰›å¸‚è·‘èµ¢BTCï¼Œç†Šå¸‚åšç©ºç›ˆåˆ©
2. **ç›¸å¯¹æœ€ä¼˜**ï¼šä¸è¿½æ±‚å®Œç¾ï¼Œè¿½æ±‚æ›´å¥½
3. **ä¸‰å¤§é“å¾‹**ï¼šç»Ÿä¸€å°è£…ã€æµ‹è¯•è§„èŒƒã€å®Œæ•´æœºåˆ¶
4. **æŒç»­å­¦ä¹ **ï¼šMemoryLayer + æ™ºèƒ½åˆ›ä¸–

**ä¸‹ä¸€æ­¥ï¼š**
- å®ŒæˆPhase 0æ¶æ„è®¾è®¡ï¼ˆæœ¬æ–‡æ¡£ï¼‰
- Phase 1: æ ¸å¿ƒè¿ç§»
- Phase 2-3: WS V3 + MemoryLayer
- Phase 4: éªŒè¯å‘å¸ƒ

---

**ä¸å¿˜åˆå¿ƒï¼Œæ–¹å¾—å§‹ç»ˆã€‚**  
**åœ¨é»‘æš—ä¸­å¯»æ‰¾äº®å…‰ï¼Œåœ¨æ··æ²Œä¸­å¯»æ‰¾è§„åˆ™ï¼Œåœ¨æ­»äº¡ä¸­å¯»æ‰¾ç”Ÿå‘½ã€‚** ğŸ’¡ğŸ“ğŸ’€ğŸŒ±

